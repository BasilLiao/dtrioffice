<script src="./thirdparty/js/jquery-barcode.min.js"></script>
<style id="print_style">
#barcodeOutput {
	margin: auto;
}

.font_28 {
	font-size: 28px;
	line-height: 28px;
}

.font_24 {
	font-size: 24px;
	line-height: 24px;
}

.font_20 {
	font-size: 20px;
	line-height: 20px;
}

.font_16 {
	font-size: 16px;
	line-height: 16px;
}

#modify_table {
	height: 600px;
	border-collapse: separate;
	border-spacing: 0px;
}

#search_table {
	height: 485px;
	border-collapse: separate;
	border-spacing: 0px;
}
</style>
<div class="pt-4 m-0 row shadow" id="production_print_body">
	<div class="col-md-12 p-0">
		<div class="mb-3 text-center">
			<h3>
				<b>生產流程卡</b>
			</h3>
		</div>
		<!-- 查詢功能 -->
		<div class="mb-3 border border-primary rounded shadow bg-light" id="productionTabContent">
			<div class="col p-0">
				<a class="btn btn-success btn-sm" data-toggle="collapse" href="#collapseSearch2" role="button" aria-expanded="true" aria-controls="collapseSearch2"> 查詢功能 :</a>
			</div>
			<div class="h5 collapse show" id="collapseSearch2">
				<div class="p-1 mb-2 mt-2 m-0 row">
					<div class="col-md-3 p-1">
						<div class="col p-1">工單號碼:</div>
						<div class="col p-1">
							<input class="col-md-12" type="text" id="s_id" name="s_id" placeholder="Ex:製令單 A512-C8763" required autofocus />
						</div>
					</div>
					<div class="col-md-2 p-1">
						<div class="col p-1">產品型號:</div>
						<div class="col p-1">
							<input class="col-md-12" type="text" id="s_model" name="s_model" placeholder="Ex:型號 301KY" required />
						</div>
					</div>
					<div class="col-md-2 p-1">
						<div class="col p-1">BOM料號:</div>
						<div class="col p-1">
							<input class="col-md-12" type="text" id="s_bom_number2" name="s_bom_number2" placeholder="Ex:90-301-Y11QJ08" required autofocus />
						</div>
					</div>
					<div class="col-md-2 p-1">
						<div class="col p-1">歷史單據(狀態):</div>
						<div class="col p-1">
							<select class="col-md-12 a_row2" id="s_history_production" name="s_history_production">
								<option value="2">準備生產中</option>
								<option value="3">已登記生產</option>
							</select>
						</div>
					</div>
				</div>
				<div class="row m-0 justify-content-center">
					<div class="row m-0 justify-content-center col-md-2 p-2">
						<button id="s_submit" class="col-md-10 btn btn-primary btn-block mr-2" type="submit">條件查詢</button>
					</div>
					<div class="row m-0 justify-content-center col-md-2 p-2">
						<button id="s_c_submit" class="col-md-10 btn btn-warning btn-block" type="button">條件清除</button>
					</div>
				</div>
			</div>
		</div>
		<!-- 功能:查詢結果(有效製令單)  /修改 -->
		<div class="mb-3 border border-primary rounded shadow bg-light">
			<div class="col p-0">
				<a class="btn btn-success btn-sm" data-toggle="collapse" href="#collapseFinish2" role="button" aria-expanded="true" aria-controls="collapseFinish2">查詢結果:</a>
			</div>
			<div class="collapse show" id="collapseFinish2">
				<div class="p-1 mb-2 mt-2 m-0 row">
					<div id="search_choose" class="row m-0">
						<div class="text-left">
							<b>顯示名稱-></b>
						</div>
					</div>
					<!-- 顯示內容 -->
					<table id="search_table" class="border border-secondary table table-sm table-hover table-striped table-bordered table-responsive">
						<thead>
							<tr id="search_thead" class="table-primary h5">
								<th scope="col" style="min-width: 80px;">功能</th>
								<th scope="col" style="min-width: 40px;">筆</th>
							</tr>
						</thead>
						<tbody id="search_tbody"></tbody>
					</table>
					<!-- 換頁 -->
					<div id="page-items" aria-label="Page" class="col">
						<ul class="pagination justify-content-center m-0">
							<li class="page-item p_p disabled"><a id="p_p" class="page-link" href="#" onclick="return templateBody.change_page(this);">Previous 10 </a></li>
							<li class="page-item p_nb p1 active"><a id="p1" class="page-link" href="#" onclick="return templateBody.change_page(this);">1</a></li>
							<li class="page-item p_nb p2"><a id="p2" class="page-link" href="#" onclick="return templateBody.change_page(this);">2</a></li>
							<li class="page-item p_nb p3"><a id="p3" class="page-link" href="#" onclick="return templateBody.change_page(this);">3</a></li>
							<li class="page-item p_nb p4"><a id="p4" class="page-link" href="#" onclick="return templateBody.change_page(this);">4</a></li>
							<li class="page-item p_nb p5"><a id="p5" class="page-link" href="#" onclick="return templateBody.change_page(this);">5</a></li>
							<li class="page-item p_nb p6"><a id="p6" class="page-link" href="#" onclick="return templateBody.change_page(this);">6</a></li>
							<li class="page-item p_nb p7"><a id="p7" class="page-link" href="#" onclick="return templateBody.change_page(this);">7</a></li>
							<li class="page-item p_nb p8"><a id="p8" class="page-link" href="#" onclick="return templateBody.change_page(this);">8</a></li>
							<li class="page-item p_nb p9"><a id="p9" class="page-link" href="#" onclick="return templateBody.change_page(this);">9</a></li>
							<li class="page-item p_nb p10"><a id="p10" class="page-link" href="#" onclick="return templateBody.change_page(this);">10</a></li>
							<li class="page-item p_n disabled"><a id="p_n" class="page-link" href="#" onclick="return templateBody.change_page(this);">Next 10 </a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<!-- [SN 自動生成器] -->
		<div class="mb-3 border border-primary rounded shadow bg-light">
			<div class="col p-0">
				<a class="btn btn-success btn-sm" data-toggle="collapse" href="#collapseAdded3" role="button" aria-expanded="true" aria-controls="collapseAdded3">編碼產生器:</a>
			</div>
			<div class="h5 collapse show m-0" id="collapseAdded3">
				<div class="p-1 row m-0 mt-2">
					<div class="row m-0 col-md-12 p-1">
						<div class="col-md-1 p-1">預覽SN碼 :</div>
						<div class="col-md-4 p-1 border border-success" id="p_sn_rule" style="background: white;" contenteditable="false"></div>
					</div>
					<div class="row m-0 p-1 col-md-12 border border-secondary" style="background: white; height: 65px; overflow-y: scroll;">
						<div class="row m-0" id="sn_p">
							<div class="p-1 production_sn d-none" id="g_id">
								<select class="select_sn p-1 pr-3 m-1">
									<option class="option_sn" value="" selected="selected">請選擇</option>
								</select>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- [MES 客製化欄位設定] -->
		<div class="mb-3 border border-primary rounded shadow bg-light">
			<div class="col p-0">
				<a class="btn btn-success btn-sm" data-toggle="collapse" href="#collapseAdded4" role="button" aria-expanded="true" aria-controls="collapseAdded3">流程卡設置:</a>
			</div>
			<div class="h5 collapse show m-0" id="collapseAdded4">
				<div class="p-1 mb-2 mt-2 m-0 row">
					<div class="m-0 col-md-2 p-2">
						<div class="col-md p-0">製成系統 (設置):</div>
						<div class="col-md p-0">
							<select id="pr_type" class="col-12">
								<option class="production_t_no" value="" selected="selected">製令單類型</option>
							</select>
						</div>
					</div>
					<div class="m-0 col-md-2 p-2">
						<div class="col-md p-0 text-light">.</div>
						<div class="col-md p-0">
							<select id="pr_w_years" class="col-12">
								<option class="pr_w_years_no" value="" selected="selected">保固年分</option>
							</select>
						</div>
					</div>
					<div class="m-0 col-md-2 p-2">
						<div class="col-md p-0 text-light">.</div>
						<div class="col-md p-0">
							<select id="ph_wc_line" class="col-12">
								<option class="ph_wc_line_no" value="" selected="selected">生產線</option>
							</select>
						</div>
					</div>
					<div class="m-0 col-md-2 p-2">
						<div class="col-md p-0 text-light">.</div>
						<div class="col-md p-0">
							<select id="ph_wpro_id" class="col-12">
								<option class="ph_wpro_no" value="" selected="selected">工作程序</option>
							</select>
						</div>
					</div>
					<div class="m-0 col-md-2 p-2">
						<div class="col-md p-0 text-light">.</div>
						<div class="col-md p-0">
							<select id="ph_ll_g_name" class="col-12">
								<option class="ph_ll_g_name_on" value="" selected="selected">產品標籤(組)</option>
							</select>
						</div>
					</div>
				</div>

				<div class="p-1 mb-2 mt-2 m-0 row">
					<div class="m-0 col-md-6 p-0 row border border-danger rounded shadow bg-warning">
						<div class="m-0 col-md-2 p-2">
							<div class="col-md p-0">客製化SN?</div>
							<div class="col-md p-0 custom-control custom-switch" style="top: 5px;">
								<input id="sn_customized_ok" class="custom-control-input" type="checkbox" />
								<!--  -->
								<label class="custom-control-label" for="sn_customized_ok" style="left: 40px;"> </label>
							</div>
						</div>
						<div class="m-0 col-md-4 p-2">
							<div class="col-md p-0">客製化SN(固定):</div>
							<div class="col-md p-0">
								<input class="col-12" type="text" id="ps_sn_burn_fixed" name="ps_sn_burn_fixed" placeholder="Ex:301KYTTS2013" />
							</div>
						</div>
						<div class="m-0 col-md-4 p-2">
							<div class="col-md p-0">流水號(浮動):</div>
							<div class="col-md p-0">
								<input class="col-12 pr-0" type="number" id="ps_sn_burn_nb" name="ps_sn_burn_nb" placeholder="Ex:0000" max="9999" min="0000" />
							</div>
						</div>
						<div class="m-0 col-md-2 p-2">
							<div class="col-md p-0">SN(長度):</div>
							<div class="col-md p-0">
								<input class="col-8 b" disabled="disabled" type="text" id="ph_ps_no_burn_nb" name="ph_ps_no_burn_nb" placeholder="" /> 碼
							</div>
						</div>
					</div>
					<div class="m-0 col-md-2 p-2">
						<div class="col-md p-0">P/N產品名(號):</div>
						<div class="col-md p-0">
							<input class="col-12" type="text" id="ph_p_name" name="ph_p_name" placeholder="Ex:90-311-T63KA01" />
						</div>
					</div>
					<div class="m-0 col-md-2 p-2">
						<div class="col-md p-0">MFG Part No(驗證碼):</div>
						<div class="col-md p-0">
							<input class="col-12" type="text" id="ph_mfg_p_no" name="ph_mfg_p_no" placeholder="Ex:123456" />
						</div>
					</div>
					<div class="m-0 col-md-2 p-2">
						<div class="col-md p-0">Parts No(組件號):</div>
						<div class="col-md p-0">
							<input class="col-12" type="text" id="ph_ps_no" name="ph_ps_no" placeholder="Ex:A123/B456/C789" />
						</div>
					</div>

				</div>
			</div>
		</div>
		<!-- [產品流程卡] -->
		<div class="mb-3 border border-primary rounded shadow bg-light">
			<div class="col p-0">
				<a class="btn btn-success btn-sm" data-toggle="collapse" href="#collapseAdded2" role="button" aria-expanded="true" aria-controls="collapseAdded2">流程卡預覽:</a>
			</div>
			<div class="col show container" id="collapseAdded2">
				<div id="table2" class="border border-dark text-center" style="background: white; height: 1503px; width: 1210px; overflow: hidden; margin: auto;">
					<!-- SN設定 -->
					<div id="snList" class="border border-dark p-0 m-0" style="height: 167px; width: 100%">
						<div class="col-12 p-0 ">
							<div class="row m-0">
								<div class="col-4 p-0">
									<div class="row m-0 border border-dark">
										<div class="col-3 p-1 pt-4 pb-3 m-0 border border-secondary font-weight-bolder h2">M/B</div>
										<div class="col-9 p-0 "></div>
									</div>
								</div>
								<div class="col-4 p-0">
									<div class="row m-0 border border-dark">
										<div class="col-3 p-1 pt-4 pb-3 m-0 border border-secondary font-weight-bolder h2">LAN</div>
										<div class="col-9 p-0 "></div>
									</div>
								</div>
								<div class="col-4 p-0">
									<div class="row m-0 border border-dark">
										<div class="col-3 p-1 pt-4 pb-3 m-0 border border-secondary font-weight-bolder h2">IMEI</div>
										<div class="col-9 p-0 "></div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-12 p-0">
							<div class="row m-0">
								<div class="col-4 p-0">
									<div class="row m-0 border border-dark">
										<div class="col-3 p-1 pt-4 pb-3 m-0 border border-secondary font-weight-bolder h2">BAT</div>
										<div class="col-9 p-0 "></div>
									</div>
								</div>
								<div class="col-4 p-0">
									<div class="row m-0 border border-dark">
										<div class="col-3 p-1 pt-4 pb-3 m-0 border border-secondary font-weight-bolder h2">WiFi</div>
										<div class="col-9 p-0 "></div>
									</div>
								</div>
								<div class="col-4 p-0">
									<div class="row m-0 border border-dark">
										<div class="col-3 p-1 pt-4 pb-3 m-0 border border-secondary font-weight-bolder h2">SN</div>
										<div class="col-9 p-0 ">
											<div id="barcodeOutputSn" class="ml-3 pt-2 bg-white"></div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div id="setOrder" class="border border-dark p-0 m-0" style="height: 180px; width: 100%">
						<div class="row m-0 h4">
							<div class="col-1 p-0 pt-1 pb-1 border border-dark font-weight-bolder">工單號</div>
							<div class="col-4 p-1 border border-secondary rounded font_28" contenteditable="true" style="height: 39px; overflow: hidden;" id="barcodeInput"></div>
							<div class="col-1 p-1 border border-dark font-weight-bolder">BOM</div>
							<div class="col-4 p-1 border border-dark font_28" id="BOMID"></div>
							<div class="col-2 p-1 border border-dark font-weight-bolder font_28" id="kind"></div>
						</div>
						<div class="row m-0">
							<div class="col-1 p-1 mb-0 pt-2 border border-dark font-weight-bolder h4">條碼</div>
							<div class="col-6 p-0 mb-0 pt-1 border border-dark rounded">
								<div class="p-0" id="barcodeOutput"></div>
							</div>
							<div class="col-1 p-1 mb-0 pt-2 border border-dark font-weight-bolder h4">客戶</div>
							<div class="col-4 p-1 mb-0 pt-2 border border-secondary rounded font_28" contenteditable="true" style="overflow: hidden; height: 48px" id="client_name"></div>
						</div>
						<div class="row m-0">
							<div class="col-1 p-0 pt-1 pb-1 mb-0 border border-dark font-weight-bolder h4">訂單號</div>
							<div class="col-3 p-1 border border-secondary rounded font_16" id="order_id" style="overflow: hidden; height: 40px"></div>
							<div class="col-1 p-0 pt-1 pb-1 mb-0 border border-dark font-weight-bolder h4">投線日</div>
							<div class="col-2 p-0 border border-secondary rounded font_28" id="datepicker1" style="overflow: hidden; height: 40px">
								<div class="d-none col-12 p-0 p-1"></div>
								<input type="text" value="" placeholder="填寫(投線日期)" class="col-12 p-0 pl-1">
							</div>
							<div class="col-1 p-0 pt-1 pb-1 mb-0 border border-dark font-weight-bolder h4">出貨日</div>
							<div class="col-2 p-0 border border-secondary rounded font_28" id="datepicker2" style="overflow: hidden; height: 40px">
								<div class="d-none col-12 p-0 p-1"></div>
								<input type="text" value="" placeholder="填寫(出貨日期)" class="col-12 p-0 pl-1">
							</div>
							<div class="col-1 p-1 mb-0 border border-dark font-weight-bolder h4">數量</div>
							<div class="col-1 p-1 border border-secondary rounded font_28" contenteditable="true" style="height: 40px; overflow: hidden;" id="p_number">1</div>
						</div>
						<div class="row m-0 ">
							<div class="col-1 p-0 pt-2 pb-1 mb-0 border border-dark font-weight-bolder h4">注意項</div>
							<div class="col-11 p-1 border border-secondary rounded text-left font_20" contenteditable="true" style="height: 50px; overflow: hidden; white-space: nowrap;" id="note"></div>
						</div>
					</div>

					<div id="setSoftware" class="border border-dark p-0 m-0" style="height: 141px; width: 100%">
						<div class="row m-0 font-weight-bolder h5">
							<div class="col-1 p-1 border border-dark">項目</div>
							<div class="col-3 row m-0 p-0 border border-dark">
								<div class="col-6 p-1 border-right border-dark">版本</div>
								<div class="col-6 p-1 border-left border-dark">ECN</div>
							</div>
							<div class="col-1 p-1 border border-dark">Chk</div>
							<div class="col-1 p-1 border border-dark">By</div>
							<div class="col-1 p-1 border border-dark">項目</div>
							<div class="col-3 p-1 border border-dark">更新版本</div>
							<div class="col-1 p-1 border border-dark">Chk</div>
							<div class="col-1 p-1 border border-dark">By</div>
						</div>
						<div class="row m-0">
							<div class="col-1 p-1 pt-2 border border-dark h6 m-0 font-weight-bolder">M/B版本</div>
							<div class="row col-3 p-0 m-0 border border-dark">
								<div class="col-6 p-1 border-right border-secondary rounded font_24" contenteditable="true" style="height: 34px; overflow: hidden;" id="mb_ver"></div>
								<div class="col-6 p-1 border-left border-secondary rounded font_24" contenteditable="true" style="height: 34px; overflow: hidden;" id="mb_ver_ecn"></div>
							</div>
							<div class="col-1 p-1 border border-dark"></div>
							<div class="col-1 p-1 "></div>
							<div class="col-1 p-1 mb-0 border border-dark font-weight-bolder h5">NVRAM</div>
							<div class="row col-3 p-0 m-0 border border-dark">
								<div class="col p-1 border border-secondary rounded font_24" contenteditable="true" style="height: 34px; overflow: hidden;" id="nvram"></div>
							</div>
							<div class="col-1 p-1 border border-dark"></div>
							<div class="col-1 p-1"></div>
						</div>
						<div class="row m-0">
							<div class="col-1 p-1 mb-0 border border-dark font-weight-bolder h5">BIOS</div>
							<div class="col-3 p-1 border border-secondary rounded font_24" contenteditable="true" style="height: 34px; overflow: hidden;" id="bios"></div>
							<div class="col-1 p-1 border border-dark"></div>
							<div class="col-1 p-1"></div>
							<div class="col-1 p-1 mb-0 border border-dark font-weight-bolder h5">MODEL</div>
							<div class="col-3 p-1 border border-secondary rounded font_24" contenteditable="true" style="height: 34px; overflow: hidden;" id="product_model_in"></div>
							<div class="col-1 p-1 border border-dark"></div>
							<div class="col-1 p-1"></div>
						</div>
						<div class="row m-0 border-bottom border-dark">
							<div class="col-1 p-1 mb-0 border border-dark font-weight-bolder h5">EC</div>
							<div class="col-3 p-1 border border-secondary rounded font_24" contenteditable="true" style="height: 34px; overflow: hidden;" id="ec"></div>
							<div class="col-1 p-1 border border-dark"></div>
							<div class="col-1 p-1"></div>
							<div class="col-1 p-1 mb-0 border border-dark font-weight-bolder h5">OS</div>
							<div class="col-3 p-1 border border-secondary rounded font_24" contenteditable="true" style="height: 34px; overflow: hidden;" id="os"></div>
							<div class="col-1 p-1 border border-dark "></div>
							<div class="col-1 p-1"></div>
						</div>
					</div>
					<div id="setHardware" class="border border-dark p-0 m-0 text-left" style="height: 720px; width: 100%; overflow: hidden;">
						<div class="row m-0">
							<div class="listLeft2 col-6 p-1">
								<div class="p-1 border-bottom border-right border-secondary itemSample ui-sortable-handle" style="height: 34px; display: none; overflow: hidden;">
									<div class="m-0 font_24" style="white-space: nowrap;">
										<span class="name font-weight-bolder pr-1"></span> <span class="content"></span> <span class="amount"></span>
									</div>
								</div>
							</div>
							<div class="listRight2 col-6 p-1"></div>
						</div>
					</div>
					<div id="setHardware_notUse" class="border border-dark p-0 m-0" style="height: 111px; width: 100%; overflow: hidden;">
						<div class="row m-0 list_notUse">
							<div class=" row m-1 font_24">
								<div class="name font-weight-bolder pr-1">注意!!不裝配 :</div>
							</div>
							<div class="d-none itemSample_notUse row m-1 font_24 border-bottom border-right border-secondary">
								<div class="name font-weight-bolder pr-1"></div>
								<div class="content pr-1"></div>
								<div class="amount"></div>
							</div>

						</div>
					</div>
					<div id="setNote" class="border border-dark p-0 m-0" style="height: 60px; width: 100%">
						<div class="row m-0 text-left" style="height: 60px;">
							<div class="col-1 p-1 border border-dark font-weight-bolder h5" style="height: 100%;">備註1</div>
							<div class="col-5 p-1 border border-dark rounded font_24" contenteditable="true" style="height: 100%; overflow: hidden;" id="note1"></div>
							<div class="col-1 p-1 border border-dark font-weight-bolder h5" style="height: 100%;">備註2</div>
							<div class="col-5 p-1 border border-dark rounded font_24" contenteditable="true" style="height: 100%; overflow: hidden;" id="note2"></div>
						</div>
					</div>
					<div id="setName" class="border border-dark font-weight-bolder h5 p-0 m-0" style="height: 80px; width: 100%">
						<div class="row m-0">
							<div class="col p-1 border border-dark">Ass'y</div>
							<div class="col p-1 border border-dark">Burn-in</div>
							<div class="col p-1 border border-dark">T1</div>
							<div class="col p-1 border border-dark">T2</div>
							<div class="col p-1 border border-dark">P1</div>
							<div class="col p-1 border border-dark">P2</div>
							<div class="col p-1 border border-dark">QC</div>
							<div class="col p-1 border border-dark">RF</div>
							<div class="col p-1 border border-dark">PM</div>
						</div>
						<div class="row m-0" style="height: 45px">
							<div class="col p-1 border border-dark"></div>
							<div class="col p-1 border border-dark"></div>
							<div class="col p-1 border border-dark"></div>
							<div class="col p-1 border border-dark"></div>
							<div class="col p-1 border border-dark"></div>
							<div class="col p-1 border border-dark"></div>
							<div class="col p-1 border border-dark"></div>
							<div class="col p-1 border border-dark"></div>
							<div class="col p-1 border border-dark"></div>
						</div>
					</div>
					<div id="workstation_inf" class="border border-dark p-0 m-0" style="height: 20px; width: 100%; font-size: 12px;">
						<div class="row m-0 text-muted">
							<div class="col-1 p-0 border border-dark">產線:</div>
							<div class="col-1 p-0 border border-dark" id="wk_inf"></div>
							<div class="col-1 p-0 border border-dark">工作程序:</div>
							<div class="col-3 p-0 border border-dark" id="wk_inf2"></div>
							<div class="col-6 p-0 border border-dark text-right" id=""></div>
						</div>
					</div>
					<div id="fromTo" class="border border-dark p-0 m-0" style="height: 22px; width: 100%; font-size: 12px;">
						<div class="row m-0 text-muted">
							<div class="col-1 p-0 border border-dark">類型/客BOM:</div>
							<div class="col-1 p-0 border border-dark" id="c2_bom_type"></div>
							<div class="col-2 p-0 border border-dark" id="c_bom_number"></div>
							<div class="col-8 p-0 border border-dark text-right" id="c2_note"></div>
						</div>
					</div>
				</div>
				<div class="collapse2 mt-2" id="">
					<div class="mb-2 text-center">
						<b>數量為100份 ,產生列印 約1分鐘 演算時間...稍後</b>
					</div>

					<!-- 設定 按鈕 -->
					<div class="row m-0 justify-content-center">
						<div class="row m-0 justify-content-center col-md-4 p-2">
							<div class="col-md-8 p-0 float-right">
								<div class="row border border-primary rounded">
									<label class="input-group-text"> <input id="production_ok" type="checkbox" checked /></label>
									<div class="border pl-1">
										<div class="group-list-10" style="height: 24px;">
											<b>投入生產 和 MES導入</b>
										</div>
									</div>
								</div>
								<div class="row border border-primary rounded mt-1">
									<label class="input-group-text"> <input id="production_sn_ok" type="checkbox" checked /></label>
									<div class="border pl-1">
										<div class="group-list-10" style="height: 24px;">
											<b>產品SN身分 區間導入</b>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="row m-0 justify-content-center col-md-2 p-2">
							<button id="p_submit" class="col-10 btn btn-primary btn-block" type="button">列印內容</button>
						</div>
						<div class="row m-0 justify-content-center col-md-2 p-2">
							<button id="a_c_submit" class="col-10 btn btn-warning btn-block" type="button">清除內容</button>
						</div>
						<div class="row m-0 justify-content-center col-md-4 p-2"></div>
					</div>
				</div>
			</div>
		</div>
		<!-- [產品流程] -->
		<div class="border border-primary rounded shadow bg-light">
			<div class="row m-0 mb-2">
				<div class="col-md-5 p-0" id="collapse_procedure">
					<a class="btn btn-success btn-sm" data-toggle="collapse" href="#collapseAdded5" role="button" aria-expanded="true" aria-controls="collapseAdded3">生產流程圖</a>
				</div>
			</div>
			<div class="collapse show p-0 m-1" id="collapseAdded5">
				<img src="./thirdparty/images/procedure.png" alt="產品流程" style="width: 100%;">
			</div>
		</div>
	</div>

	<!-- 浮動電梯 -->
	<div class="text-center fixed-bottom m-3" style="width: 140px; font-family: Microsoft JhengHei; font-size: 16px; left: auto;">
		<div id="top" class="shadow from_move row p-2 m-2 bg-light border border-primary rounded" style="cursor: pointer;">
			<img class="col-md-3 pl-0 pr-0" alt="top" src="./thirdparty/images/move_arrow.gif" style="transform: rotate(-135deg); max-width: 25px;" />
			<div class="col-md-9 pr-0" style="max-width: 80px;">Top</div>
		</div>
		<div id="collapseAdded_1" class="shadow from_move row p-2 m-2 bg-light border border-primary rounded" style="cursor: pointer;">
			<img class="col-md-3 pl-0 pr-0" alt="流程卡" src="./thirdparty/images/move_arrow.gif" style="transform: rotate(88deg); max-width: 25px;" />
			<div class="col-md-9 pr-0" style="max-width: 80px;">流程卡</div>
		</div>
		<div id="collapseAdded_2" class="shadow from_move row p-2 m-2 bg-light border border-primary rounded" style="cursor: pointer;">
			<img class="col-md-3 pl-0 pr-0" alt="列印內容" src="./thirdparty/images/move_arrow.gif" style="transform: rotate(88deg); max-width: 25px;" />
			<div class="col-md-9 pr-0" style="max-width: 80px;">列印內容</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	console.log("production_print_body");
	templateBody = new Vue({
		el : "#production_print_body",
		data : {
			l_search_thead : "", //鎖定查詢
			search_list : "",
			item_list : "",
			item_acc_list : "",

			production_list : "",
			softwareVer_list : "",
			sn_all_list : "",
			pr_type : "",
			pr_w_years : "",
			ph_wpro_id : "",
			ph_ll_g_name_id : "",
			ph_wc_line : "",
			sn_all_nb : "",
			item_nb_max : 0, //最大ID數
			//分頁功能
			page_max : 100, //當前本批 筆數
			page_max_total : 100, //最大總數
			page_batch : 0, //第幾批
			page_batch_total : 100, //每批間格值
			page_every : 10, //當前每頁筆數
			page_stay : 1, //當前頁數

			d_1 : "", //當前的 投線日
			d_2 : "", //當前的 出貨日
			s_3 : 0, //當前產品ID

			isDragging : false, //移動
		},
		created : function() {
			//初始化
			console.log(main.contentData.templateInfo.body);
			this.production_list = main.contentData.templateInfo.body["production_list"];
			this.softwareVer_list = main.contentData.templateInfo.body["softwareVer_list"];
			this.sn_all_list = main.contentData.templateInfo.body["sn_all_list"];
			this.pr_type = main.contentData.templateInfo.body["pr_type"];
			this.pr_w_years = main.contentData.templateInfo.body["pr_w_years"];
			//伺服器沒串接上
			var pd_wp = main.contentData.templateInfo.body["ph_wpro_id"];
			var pd_we = main.contentData.templateInfo.body["ph_wpro_id"];
			var pd_gl = main.contentData.templateInfo.body["ph_wpro_id"];
			pd_wp = (pd_wp == null ? pd_wp : pd_wp["wProgram"]);
			pd_we = (pd_we == null ? pd_we : pd_we["wLine"]);
			pd_gl = (pd_gl == null ? pd_gl : pd_gl["gLabel"]);
			if (pd_wp != null) {
				this.ph_wpro_id = JSON.parse(pd_wp);
			} else {
				this.ph_wpro_id = "";
			}
			if (pd_we != null) {
				this.ph_wc_line = JSON.parse(pd_we);
			} else {
				this.ph_wc_line = "";
			}
			if (pd_gl != null) {
				this.ph_ll_g_name = JSON.parse(pd_gl);
			} else {
				this.ph_ll_g_name = "";
			}

			//=====製令 清單=====
			for (var i = 0; i < this.production_list[0].length; i++) {
				var choose_check = '[<div class="text-left form-check">';
				choose_check += '<input class="form-check-input" type="checkbox" value="" id="t_' + i + '" checked>';
				choose_check += '<label class="form-check-label" for="t_' + i + '">' + this.production_list[0][i] + "</label>";
				choose_check += "</div>]";
				$("#search_choose").append(choose_check);
			}
			//t_header
			for (var i = 0; i < this.production_list[0].length; i++) {
				if (i == 0 || i == 2 || i == 4 || i == 5 || i == 6 || i == 7 || i == 8 || i == 9 || i == 10 || i == 11 || i == 13) {
					min_width = 180;
				}
				var std2 = '<th style="min-width: ' + min_width + 'px;" class="t_' + i + '" scope="col">';
				std2 += this.production_list[0][i] + "</th>";
				$("#search_thead").append(std2);
				min_width = 120;
			}

			//sn_all_list(SN序號規則)
			var sn_group = 0;
			var p_s_sn_id = "";
			var p_o_sn = "";
			for (var i = 0; i < this.sn_all_list.length; i++) {
				var sn = this.sn_all_list[i];
				//排除基本規則(建立類數量)
				if (sn.sn_group > 0 && sn_group != sn.sn_group) {
					sn_group = sn.sn_group;
					var p_s_sn = $(".production_sn").clone();
					p_s_sn.removeClass("d-none");
					p_s_sn.removeClass("production_sn");
					p_s_sn.attr("id", "g_" + sn["sn_group"]);
					p_s_sn.find(".option_sn").text(sn.sn_group_name);
					p_s_sn.appendTo("#sn_p");
					p_s_sn_id = "g_" + sn["sn_group"];
				} else if (sn.sn_group == 0) {
					continue;
				}
				//建立項目
				var p_o_sn = $(".production_sn .option_sn").clone();
				p_o_sn.addClass("g_o_" + sn.sn_group);
				p_o_sn.removeClass("option_sn");
				p_o_sn.attr("id", sn.sn_id);
				p_o_sn.attr("value", sn.sn_value);
				p_o_sn.text(sn.sn_name);
				p_o_sn.removeAttr("selected", " ");
				p_o_sn.appendTo("#" + p_s_sn_id + " select");
			}

			//建立製令單類型
			for (var type_one = 0; type_one < this.pr_type.length; type_one++) {
				var production_t_no = $(".production_t_no").clone();
				production_t_no.removeClass("production_t_no");
				production_t_no.attr("id", this.pr_type[type_one].key);
				production_t_no.attr("value", this.pr_type[type_one].key);
				production_t_no.text(this.pr_type[type_one].value);
				production_t_no.removeAttr("selected", " ");
				production_t_no.appendTo("#pr_type");
			}
			//建立保固年分
			for (var pr_w_years_one = 0; pr_w_years_one < this.pr_w_years.length; pr_w_years_one++) {
				var pr_w_years_no = $(".pr_w_years_no").clone();
				pr_w_years_no.removeClass("pr_w_years_no");
				pr_w_years_no.attr("id", this.pr_w_years[pr_w_years_one].key);
				pr_w_years_no.attr("value", this.pr_w_years[pr_w_years_one].key);
				pr_w_years_no.text(this.pr_w_years[pr_w_years_one].value);
				pr_w_years_no.removeAttr("selected", " ");
				pr_w_years_no.appendTo("#pr_w_years");
			}
			//建立工作站程序
			if (this.ph_wpro_id != null) {
				for (var ph_wpro_id_one = 0; ph_wpro_id_one < this.ph_wpro_id.length; ph_wpro_id_one++) {
					var ph_wpro_no = $(".ph_wpro_no").clone();
					ph_wpro_no.removeClass("ph_wpro_no");
					ph_wpro_no.attr("id", this.ph_wpro_id[ph_wpro_id_one].key);
					ph_wpro_no.attr("value", this.ph_wpro_id[ph_wpro_id_one].key);
					ph_wpro_no.text(this.ph_wpro_id[ph_wpro_id_one].value);
					ph_wpro_no.removeAttr("selected", " ");
					ph_wpro_no.appendTo("#ph_wpro_id");
				}

				for (var ph_wc_line_one = 0; ph_wc_line_one < this.ph_wc_line.length; ph_wc_line_one++) {
					var ph_wc_line_no = $(".ph_wc_line_no").clone();
					ph_wc_line_no.removeClass("ph_wc_line_no");
					ph_wc_line_no.attr("id", this.ph_wc_line[ph_wc_line_one]);
					ph_wc_line_no.attr("value", this.ph_wc_line[ph_wc_line_one]);
					ph_wc_line_no.text(this.ph_wc_line[ph_wc_line_one]);
					ph_wc_line_no.removeAttr("selected", " ");
					ph_wc_line_no.appendTo("#ph_wc_line");
				}
				for (var ph_ll_g_name_one = 0; ph_ll_g_name_one < this.ph_ll_g_name.length; ph_ll_g_name_one++) {
					var ph_ll_g_name_on = $(".ph_ll_g_name_on").clone();
					ph_ll_g_name_on.removeClass("ph_ll_g_name_on");
					ph_ll_g_name_on.attr("id", this.ph_ll_g_name[ph_ll_g_name_one]);
					ph_ll_g_name_on.attr("value", this.ph_ll_g_name[ph_ll_g_name_one]);
					ph_ll_g_name_on.text(this.ph_ll_g_name[ph_ll_g_name_one]);
					ph_ll_g_name_on.removeAttr("selected", " ");
					ph_ll_g_name_on.appendTo("#ph_ll_g_name");
				}
			}
			//t_body
			this.production_update();
			//動態監聽顯示是否用 客製化SN
			$(document).on("click", "#sn_customized_ok", function(event) {
				if ($("#sn_customized_ok").prop("checked")) {
					$("#sn_p .p-1").attr("disabled", "disabled");
				} else {
					$("#sn_p .p-1").removeAttr("disabled");
				}
			});
			//動態監聽顯示Table 物件 查看開關
			$(document).on("click", "#search_choose input", function(event) {
				templateBody.search_choose(event);
			});
			//動態監聽production_ok 投入生產 是否有點及勾選
			$(document).on("click", "#production_ok", function(event) {
				console.log($("#production_ok").prop("checked"));
				if ($("#production_ok").prop("checked")) {
					$("#production_sn_ok").removeAttr("disabled");
				} else {
					if ($("#production_sn_ok").prop("checked")) {
						$("#production_sn_ok").trigger("click");
					}
					$("#production_sn_ok").attr("disabled", "disabled");
				}
			});
			//查詢監聽
			$(document).on("click", "#s_submit", function(event) {
				//頁數-重製分頁
				templateBody.change_page_init();
				templateBody.send_search("production");
			});
			//清除修改
			$(document).on("click", "#a_c_submit", function(event) {
				templateBody.rm_added();
			});

			//頁數-重製分頁
			$(document).on("click", "#p_submit", function(event) {
				templateBody.send_search("update");
			});
			//移動
			$(document).on("click", ".from_move", function(event) {
				templateBody.from_move(event);
			});

			// 條件清除
			$(document).on("click", "#s_c_submit", function(event) {
				templateBody.rm_select();
			});
			//日期
			$(document).ready(function(event) {
				$("#datepicker1 input").datepicker({
					dateFormat : "yy-mm-dd",
					minDate : 0,
				});
			});
			$(document).ready(function(event) {
				$("#datepicker2 input").datepicker({
					dateFormat : "yy-mm-dd",
					minDate : 0,
				});
			});
			//客戶欄位
			$(document).on("focusout", "#client_name", function(event) {
				templateBody.sofwareVer_in();
			});
			//產品SN選單
			$(document).on("change", ".select_sn", function(event) {
				templateBody.select_sn();
			});
			//生產線
			$(document).on("change", "#ph_wc_line", function(event) {
				$('#wk_inf').text($('#ph_wc_line').find("option:selected").text());
			});
			//工作站
			$(document).on("change", "#ph_wpro_id", function(event) {
				$('#wk_inf2').text($('#ph_wpro_id').find("option:selected").text());
			});

			//barcode 觸發(工單號)
			var lastContent = "";
			$(document).on("focusin", "#barcodeInput", function(event) {
				lastContent = this.innerHTML;
			});
			$(document).on("focusout", "#barcodeInput", function(event) {
				templateBody.createBarcode(this.innerHTML);
			});
			$(document).on("keyup", "#barcodeInput", function(event) {
				if (event.keyCode == 13) {
					this.innerHTML = lastContent;
					templateBody.createBarcode(this.innerHTML);
				} else {
					lastContent = this.innerHTML;
				}
			});
			//預覽監聽
			$(document).on("click", ".a_submit", function(event) {
				var id_p = event.target.attributes.user_id.value;
				templateBody.event = event;
				$("#a_c_submit").trigger("click");
				//進行預覽
				templateBody.choose_show("資料顯示", event);
				templateBody.event = "";
				setTimeout(function() {
					$("html,body").animate({
						scrollTop : 1000,
					}, "slow");
				}, 500);
			});
			//自訂義SN長度
			$(document).on("change", "#ps_sn_burn_nb", function(event) {
				var ps_size = $("#ps_sn_burn_fixed").val() + $("#ps_sn_burn_nb").val();
				$("#ph_ps_no_burn_nb").val(ps_size.length);
			});

		},
		methods : {
			search_choose : function(event) {
				console.log(event.target.checked);
				if (!event.target.checked) {
					$("#search_thead ." + event.target.id).hide();
					$("#search_tbody ." + event.target.id).hide();
				} else {
					$("#search_thead ." + event.target.id).show();
					$("#search_tbody ." + event.target.id).show();
				}
			},
			//查詢-製令更新
			production_update : function() {
				$("#search_tbody").empty();
				//頁數-刷新
				this.change_page_update();
				//t_body
				var checked = 12;
				var kind = 13;
				var d_none = 14;//多於隱藏
				var shty2 = "";
				for (var i = 1; i < this.production_list.length; i++) {
					//頁數-每頁顯示(不再顯示範圍內則隱藏)
					var page_group = this.change_page_btn(i);
					var s_list = this.production_list[i][2];
					//功能
					var a_submit = '<div class="md-6">';
					a_submit += '<button user_id="' + s_list + '" class="btn btn-warning btn-sm btn-block a_submit">';
					a_submit += "預覽</button></div>";
					//筆數
					shty2 = '<tr class=" page_all  t_row' + s_list + " " + page_group + ' " style="white-space: nowrap;">';
					shty2 += '<th class="ml-0 col-md-12 row">';
					shty2 += a_submit + "</th></tr>"
					$("#search_tbody").append(shty2);
					//計數量
					$("#search_tbody .t_row" + s_list).append("<td >" + i + "</td>");
					var trow2 = "";
					for (var j = 0; j < this.production_list[i].length; j++) {
						trow2 = "<td class='s_" + j + "' >" + this.production_list[i][j] + "</td>";
						if (j > d_none) {
							trow2 = "<td class='d-none s_" + j + "' >" + this.production_list[i][j] + "</td>";
						}
						$("#search_tbody .t_row" + s_list).append(trow2);
					}
				}

				//sn_all_list(SN序號規則)
				var sn_group = 0;
				var p_s_sn_id = "";
				var p_o_sn = "";
				//清除
				for (var i = 0; i < this.sn_all_list.length; i++) {
					$("#g_" + i).remove();
				}

				for (var i = 0; i < this.sn_all_list.length; i++) {
					var sn = this.sn_all_list[i];
					//排除基本規則(建立類數量)
					if (sn.sn_group > 0 && sn_group != sn.sn_group) {
						sn_group = sn.sn_group;
						var p_s_sn = $(".production_sn").clone();
						p_s_sn.removeClass("d-none");
						p_s_sn.removeClass("production_sn");
						p_s_sn.attr("id", "g_" + sn["sn_group"]);
						p_s_sn.find(".option_sn").text(sn.sn_group_name);
						p_s_sn.appendTo("#sn_p");
						p_s_sn_id = "g_" + sn["sn_group"];
					} else if (sn.sn_group == 0) {
						continue;
					}
					//建立項目
					var p_o_sn = $(".production_sn .option_sn").clone();
					p_o_sn.addClass("g_o_" + sn.sn_group);
					p_o_sn.removeClass("option_sn");
					p_o_sn.attr("id", sn.sn_id);
					p_o_sn.attr("value", sn.sn_value);
					p_o_sn.text(sn.sn_name);
					p_o_sn.removeAttr("selected", " ");
					p_o_sn.appendTo("#" + p_s_sn_id + " select");
				}
			},
			//移動電梯
			from_move : function(event) {
				console.log(event.currentTarget.id);
				switch (event.currentTarget.id) {
				case "top":
					setTimeout(function() {
						$("html,body").animate({
							scrollTop : 80,
						}, "slow");
					}, 200);
					break;
				case "collapseAdded_1":
					if ($("#collapse_report a").attr("aria-expanded") == "false") {
						$("#collapse_report a").trigger("click");
					}
					setTimeout(function() {
						$("html,body").animate({
							scrollTop : 990,
						}, "slow");
					}, 200);
					break;
				case "collapseAdded_2":
					if ($("#collapse_report a").attr("aria-expanded") == "false") {
						$("#collapse_report a").trigger("click");
					}
					setTimeout(function() {
						$("html,body").animate({
							scrollTop : 2110,
						}, "slow");
					}, 200);
					break;
				default:
					break;
				}
			},
			rm_added : function() {
				$("#BOMID").text("");
				$("#kind").text("");
				$("#client_name").text("");

				$("#barcodeOutput div").remove();

				$("#group_number_0").val(1);
				$("#c2_bom_type").text("");
				$("#c_bom_number").text("");
				$("#barcodeInput").text("");
				$("#order_id").text("");
				$("#datepicker1 input").val("");
				$("#datepicker2 input").val("");
				$(".textN1").text("");
				$(".textN2").text("");
				$(".coll2").text("");
				$(".othersEdit").text("");
				$("#barcodeOutputSn").text("");

				$("#collapseAdded2 .listLeft2 .item").remove();
				$("#collapseAdded2 .listRight2 .item").remove();
				$("#collapseAdded2 .list_notUse .item_notUse").remove();

			},

			//清除選擇
			rm_select : function() {
				$("#s_id").val("");
				$("#s_model").val("");
				$("#s_bom_number2").val("");
			},

			//選擇  預覽
			choose_show : function(a_u_type, production) {
				this.rm_added();
				var id_p = "";
				var id = "";
				var come_from = "自訂";

				//自動帶入
				id_p = production.target.attributes.user_id.value;
				id = $(".t_row" + id_p + " .s_3").text();

				//項目帶入(客戶+單據來源)
				$("#c_bom_number").text($(".t_row" + id_p + " .s_5").text());
				$("#barcodeInput").text($(".t_row" + id_p + " .s_2").text());
				$("#client_name").text($(".t_row" + id_p + " .s_8").text());
				$("#order_id").text($(".t_row" + id_p + " .s_7").text());
				$("#p_number").text($(".t_row" + id_p + " .s_6").text());

				$("#barcodeInput").trigger("focusout");
				$("#barcodeInput").attr("contenteditable", false);
				$("#order_id").attr("contenteditable", false);
				$("#client_name").attr("contenteditable", false);
				$("#p_number").attr("contenteditable", true);

				$("#ph_mfg_p_no").val($(".t_row" + id_p + " .s_19").text());
				$("#ph_ps_no").val($(".t_row" + id_p + " .s_20").text());

				//共用欄位位				
				come_from = $(".t_row" + id_p + " .s_11").text();//來源
				$("#ver_motherboard").text($(".t_row" + id_p + " .s_10")[0].innerText);//MB
				this.s_3 = $(".t_row" + id_p + " .s_3")[0].innerText;//BOM ID
				$("#BOMID").text($(".t_row" + id_p + " .s_4")[0].innerText);//BOM ID
				$("#kind").text($(".t_row" + id_p + " .s_17")[0].innerText);//技轉/量產
				$("#datepicker2 div").text($(".t_row" + id_p + " .s_15")[0].innerText);
				$("#datepicker2 input").val($(".t_row" + id_p + " .s_15")[0].innerText);

				//比對軟體
				this.sofwareVer_in();

				//規格定義
				var group_tbody = "";
				var $listLeft = $("#collapseAdded2 .listLeft2");
				var $listRight = $("#collapseAdded2 .listRight2");
				var $list_notUse = $("#collapseAdded2 .list_notUse");
				var $sample = $listLeft.find(".itemSample");
				var $sample_notUse = $list_notUse.find(".itemSample_notUse");
				//規格清除
				$listLeft.find(".item").remove();
				$listRight.find(".item").remove();
				$list_notUse.find(".item_notUse").remove();

				var $target = $listLeft;
				var counting = 0;
				var columnItemNumber = 21;
				//規格資料
				var group_list = JSON.parse($(".t_row" + id_p + " .s_16")[0].innerText);
				var g_l_not = group_list.not;
				var g_l_have = group_list.have;
				//規格生成-have->上面顯示
				for (var i = 0; i < g_l_have.length; i++) {
					var $new = $sample.clone().show().removeClass("itemSample").addClass("item");
					$new.find(".name").text(g_l_have[i]['name']);//項目名稱
					$new.find(".content").html(g_l_have[i]['content']);//內容
					$new.find(".amount").text(g_l_have[i]['amount']);//數量
					counting = counting + 1;
					if (counting > columnItemNumber)
						$target = $listRight;
					$target.append($new);
				}
				//規格生成-not->下面顯示
				for (var i = 0; i < g_l_not.length; i++) {
					var $new_notUse = $sample_notUse.clone().show().removeClass("d-none").removeClass("itemSample_notUse").addClass("item_notUse");
					$new_notUse.find(".name").html(g_l_not[i]['name']);//項目名稱
					$new_notUse.find(".content").html(g_l_not[i]['content']);//內容
					$list_notUse.append($new_notUse);
				}

				//底部
				var fullDate = new Date();
				var twoDigitMonth = fullDate.getMonth() + 1 >= 10 ? fullDate.getMonth() + 1 : "0" + (fullDate.getMonth() + 1);
				var currentDate = fullDate.getFullYear() + "-" + twoDigitMonth + "-" + fullDate.getDate();
				$("#c2_bom_type").text($(".t_row" + id_p + " .s_12")[0].innerText);

				var c2_note = "表單編號:QR-701-06 / 規格負責人 : " + $(".t_row" + id_p + " .s_18")[0].innerText;
				c2_note += " / 建單日期 : " + currentDate + " / 建單人 : " + $("#nav_account").text();
				c2_note += " / 單據來源 : " + come_from;
				$("#c2_note").text(c2_note);
			},
			//比對規格->自動帶入軟體定義
			sofwareVer_in : function() {
				//console.log( this.softwareVer_list[$("#client_name").text()+"-"+ $("#BOMID").text()]);
				var software_in = this.softwareVer_list[$("#client_name").text() + "-" + $("#BOMID").text()];
				if (software_in != null && software_in.length > 0) {
					var mb_ver_4 = 4;
					$("#mb_ver").text(software_in[4]);
					$("#mb_ver_ecn").text(software_in[5]);
					$("#nvram").text(software_in[6]);
					$("#bios").text(software_in[7]);
					$("#product_model_in").text(software_in[8]);
					$("#ec").text(software_in[9]);
					$("#os").text(software_in[10]);
					$("#note").text(software_in[11]);
					$("#note1").text(software_in[12]);
					$("#note2").text(software_in[13]);
				} else {
					$("#mb_ver").text("");
					$("#mb_ver_ecn").text("");
					$("#nvram").text("");
					$("#bios").text("");
					$("#product_model_in").text("");
					$("#ec").text("");
					$("#os").text("");
					$("#note").text("");
					$("#note1").text("");
					$("#note2").text("");
				}
			},
			//select_sn 選單
			select_sn : function() {
				var rules = "";
				var select_sn = $(".select_sn");
				for (var i = 1; i < select_sn.length; i++) {
					rules += $("#g_" + i + " select").children("option:selected").val();
				}
				$("#p_sn_rule").text(rules);
			},
			//頁數-初始化(新增 or 修改 or 刪除 or 條件 要重製)
			change_page_init : function() {
				//active 更換為第一格
				var a = "active";
				var d = "disabled";
				$(".page-item").removeClass(a);
				$(".page-item").removeClass(d);
				for (var re_page = 1; re_page <= 10; re_page++) {
					var now_page = re_page + (this.page_batch * 10);
					//如果就在第一頁 不需更換
					if (!$("#page-items .p" + now_page).hasClass("p" + re_page)) {
						$("#page-items .p" + now_page).addClass("p" + re_page);
						$("#page-items .p" + re_page).removeClass("p" + now_page);
						$("#page-items .p" + re_page + " a").text(re_page);
						$("#page-items .p" + re_page + " a").attr("id", "p" + re_page);
					}
					if (re_page == 1) {
						$("#page-items .p" + re_page).addClass(a);
					}
				}
				//分頁功能
				this.page_max = 100;//當前本批 筆數
				this.page_max_total = 100;//最大總數
				this.page_batch = 0;//第幾批
				this.page_batch_total = 100;//每批間格值
				this.page_every = 10;//當前每頁筆數
				this.page_stay = 1;//當前頁數
			},
			//頁數-刷新
			change_page_update : function() {
				//頁數-取得當前最大筆數 && 頁數
				this.page_max = this.search_list.length;
				$(".p_n").removeClass("disabled");
				if (this.page_max < this.page_max_total) {
					$(".p_n").addClass("disabled");
				}
				$(".p_p").removeClass("disabled");
				if (this.page_batch < 1) {
					$(".p_p").addClass("disabled");
				}
				//頁數-隱藏多於頁數
				$(".p_nb").addClass("disabled");

			},
			//頁數-換頁按鈕建置(頁數-每頁顯示)
			change_page_btn : function(i) {
				var d_none = "";
				if (i > (this.page_every * this.page_stay)) {
					d_none = "d-none";
				}
				//頁數-(個位數)+(十位數)
				var page_group = "pg_" + (Math.floor((i - 1) / this.page_every) + 1 + (this.page_batch * 10));
				var page_nb = "p" + (Math.floor((i - 1) / this.page_every) + 1 + (this.page_batch * 10));
				$("." + page_nb).removeClass("disabled");
				return page_group + " " + d_none;
			},
			//頁數-換頁查詢
			change_page : function(event) {
				var d = "disabled";
				var d_n = "d-none";
				var a = "active";
				var pg = "pg_";
				console.log("page btn is:" + event.text);
				//選定頁數
				if (event.id != "p_p" && event.id != "p_n") {
					$(".page-item").removeClass(a);
					$("." + event.id).addClass(a);

					$(".page_all").addClass(d_n);
					$("." + pg + event.text).removeClass(d_n);

				} else if (event.id == "p_p") {//上10頁(批數 要大於1)
					if (this.page_batch > 0) {
						//換上一批次 頁數
						$(".page-item").removeClass(a);

						for (var i = 1; i <= 10; i++) {
							var now_page = i + (this.page_batch * 10);
							var previous_page = i + ((this.page_batch) * 10) - 10;
							$(".p" + now_page).addClass("p" + previous_page);
							$(".p" + previous_page).removeClass("p" + now_page);
							$(".p" + previous_page + " a").text(previous_page);
							$(".p" + previous_page + " a").attr("id", "p" + previous_page);
							if (i == 1) {
								$(".p" + previous_page).addClass(a);
							}
						}
						this.page_batch -= 1;
						this.send_search("");
					}
				} else if (event.id == "p_n") {//下10頁(必須滿100筆最大量 )
					if (this.page_max >= this.page_max_total) {
						//換下一批次 頁數
						$(".page-item").removeClass(a);
						for (var i = 1; i <= 10; i++) {
							var now_page = i + (this.page_batch * 10);
							var next_page = i + ((this.page_batch + 1) * 10);
							$(".p" + now_page).addClass("p" + next_page);
							$(".p" + next_page).removeClass("p" + now_page);
							$(".p" + next_page + " a").text(next_page);
							$(".p" + next_page + " a").attr("id", "p" + next_page);
							if (i == 1) {
								$(".p" + next_page).addClass(a);
							}
						}
						this.page_batch += 1;
						this.send_search("");
					}
				}
				return false;
			},
			//傳送 查詢
			send_search : function(select) {
				var content = new Object();
				var search_list = [];
				var order = "search_update"; //指令
				var url = "";

				switch (select) {
				case "": //BOM 查詢
					for (var i = 1; i < $("#s_l_list div").length; i++) {
						search_list.push($("#s_l_list div")[i].innerText);
					}
					content.page_nb = this.page_batch * this.page_batch_total; //批次(起始數)
					content.page_total = this.page_batch_total; //(每次要的最大數量)

					content.search_list = search_list;
					content.product_id = templateBody.s_4;
					content.user = $("#nav_account").text();
					url = "./production_print.do";
					break;
				case "update": //更新進度
					//有勾選->登記
					if ($("#production_ok").prop("checked")) {
						//製令流程(更新)
						var chg_row = $('.t_row' + $("#barcodeInput").text());
						content.production_id = $("#barcodeInput").text();
						content.product_progress = 3;
						//登記(自訂單的話) 新增單據
						content.order_id = $("#order_id").text();
						content.client_name = $("#client_name").text();

						var quantity = 0;
						if ($("#p_number").text() != "" && $.isNumeric($("#p_number").text())) {
							quantity = $("#p_number").text();
						}

						//內容
						content.bom_id = chg_row.find('.s_3').text();
						content.bom_product_id = chg_row.find('.s_4').text();//公司BOM
						content.bom_product_c_id = chg_row.find(".s_5").text();//客戶BOM
						content.product_model = chg_row.find('.s_9').text();
						content.version_motherboard = chg_row.find('.s_10').text();
						content.come_from = chg_row.find('.s_11').text();
						content.bom_type = chg_row.find('.s_12').text();
						content.bom_product_content = chg_row.find('.s_16').text();//規格
						content.product_hope_date = chg_row.find('.s_15').text();//預計時間
						content.production_quantity = quantity;//數量
						//軟體定義項目
						content.mb_ver = $("#mb_ver").text();
						content.mb_ver_ecn = $("#mb_ver_ecn").text();
						content.nvram = $("#nvram").text();
						content.bios = $("#bios").text();
						content.product_model_in = $("#product_model_in").text();
						content.ec = $("#ec").text();
						content.os = $("#os").text();
						content.note = $("#note").text();
						content.note1 = $("#note1").text();
						content.note2 = $("#note2").text();
						content.software_id = 0;
						//MES 補充資訊
						content.pr_p_v = "";
						content.pr_type = $("#pr_type").val();
						content.pr_w_years = $("#pr_w_years").val();
						content.ph_wpro_id = $("#ph_wpro_id").val();
						content.ph_wc_line = $("#ph_wc_line").val();
						content.ph_ll_g_name = $("#ph_ll_g_name").val();
						//SN 登記演算
						var sn_array = [];
						if ($("#production_sn_ok").prop("checked")) {
							var select_sn = $(".select_sn");
							for (var i = 1; i < select_sn.length; i++) {
								var sn_obg = new Object();
								var sn_v = $("#g_" + i + " select").children("option:selected").val();
								var sn_n = $("#g_" + i + " select").children("option:selected").text();
								var sn_g = $("#g_" + i + " select").children("option:selected")[0].className.replace("g_o_", "");
								var sn_i = $("#g_" + i + " select").children("option:selected")[0].id;
								//檢驗失敗
								if (sn_g == "option_sn" && !$("#sn_customized_ok").prop("checked")) {
									main.alertshow(true, "[流程卡][SN]尚未填寫完整,請再次檢查清楚!!");
									return;
								}
								sn_obg.sn_group = sn_g;
								sn_obg.sn_name = sn_n;
								sn_obg.sn_value = sn_v;
								sn_obg.sn_id = sn_i;
								sn_array[i - 1] = sn_obg;
							}
						}
						//有客製化SN
						if ($("#sn_customized_ok").prop("checked")) {
							var sn_array = [];
							content.ps_sn_burn_fixed = $("#ps_sn_burn_fixed").val().replaceAll(' ', '');
							content.ps_sn_burn_nb = $("#ps_sn_burn_nb").val().replaceAll(' ', '');
							if ((content.pr_type == "A511_no_and_has_sn" || content.pr_type == "A511_has_sn")
									&& (content.pr_type == "A521_no_and_has_sn" || content.pr_type == "A521_has_sn")
									&& (content.ps_sn_burn_fixed == "" || content.ps_sn_burn_nb == "")) {
								main.alertshow(true, "[流程卡][SN]尚未填寫完整,請再次檢查清楚!!");
								return;
							}
						}
						content.ph_mfg_p_no = $("#ph_mfg_p_no").val();
						content.ph_ps_no = $("#ph_ps_no").val();
						content.ph_p_name = $("#ph_p_name").val();
						content.sn = sn_array;

						order = "production_search_update";
						//檢查內容是否正確
						if (content.mb_ver == "" || content.mb_ver_ecn == "" || content.nvram == "" || //
						content.bios == "" || content.product_model_in == "" || content.ec == "" || content.os == "") {
							main.alertshow(true, "[軟體定義]尚未填寫完整,請再次檢查清楚!!");
							return;
						}
						if (content.bom_id == "" || content.product_model == "" || //
						content.version_motherboard == "" || content.bom_product_id == "" || //
						content.production_quantity == "" || content.production_order_id == "" || //
						content.production_client_name == "" || content.production_id == "" || //
						$("#datepicker1 input").val() == "" || $("#datepicker2 input").val() == "") {
							main.alertshow(true, "[流程卡]尚未填寫完整,請再次檢查清楚!!");
							return;
						}
					} else {
						//沒勾選->不登記->不繼續
						templateBody.printDiv2();
						return;
					}
					url = "./production_progress_update.do";
					break;
				case "production": //查詢 製令單
					order = "production_search";
					content.production_id = $("#s_id").val();
					content.product_model = $("#s_model").val();
					content.bom_product_id = $("#s_bom_number2").val();
					content.product_progress = $("#s_history_production").val();
					url = "./production_print.do";
					break;
				}
				var data = JSON.stringify({
					data : {
						datetime : "",
						action : "R",
						whoami : main.loginData.account,
						cellBackName : "bodyAfter",
						cellBackOrder : order,
						content : content,
					},
				});
				main.ajaxSend(url, data);
			},
			createBarcode : function(code) {
				$("#barcodeOutput").barcode(code, "code39", {
					barWidth : 2,
					barHeight : 20,
					fontSize : 14,
				});
			},
			//產生回傳
			createBarcodeForPrint : function(code) {
				$("#barcodeOutputSn").barcode(code, "code39", {
					barWidth : 1,
					barHeight : 25,
					fontSize : 20,
				});
				$("#barcodeOutputSn").css("transform", "scale(1.25)");
			},
			//列印
			printDiv : function() {
				var divToPrint = document.getElementById("table2");
				var style = document.getElementById("print_style");
				var newWin = window.open("", "Print-Window");
				newWin.document.open();
				newWin.document.write("<html>" + "<head>" + '<link rel="stylesheet" href="./thirdparty/css/bootstrap-4.4.1.min.css" />' + style.outerHTML
						+ "</head>" + '<body onload="window.print()" class="container text-center" id="main">' + "<div>" + divToPrint.innerHTML + "</div>"
						+ "</body>" + "</html>");
				newWin.document.close();
				setTimeout(function() {
					newWin.close();
				}, 2000);
			},
			//列印
			printDiv2 : function() {
				this.d_1 = $("#datepicker1 input").val();
				this.d_2 = $("#datepicker2 input").val();
				$("#datepicker1 input").addClass("d-none");
				$("#datepicker2 input").addClass("d-none");
				$("#datepicker1 div").removeClass("d-none");
				$("#datepicker2 div").removeClass("d-none");
				$("#datepicker1 div").text(this.d_1);
				$("#datepicker2 div").text(this.d_2);
				//設置數量
				var number_total = parseInt($("#p_number").text());
				if (this.sn_all_nb != null)
					this.createBarcodeForPrint(this.sn_all_nb[0]);
				var style = document.getElementById("print_style");
				var newWin = ""; //= window.open("", "Print-Window");
				var divToPrint = "";
				var print_production = "";
				var print_page = 0; //有幾分頁
				var print_nb = 200; //每頁幾筆
				//每分頁延遲
				function print_Loop(new_nb, in_total, in_nb) {
					setTimeout(function() {
						//如果小於分頁數
						var newWin = "";
						if (in_total - new_nb < in_nb) {
							in_nb = number_total - new_nb;
						}
						for (var i = 1; i <= in_nb; i++) {
							if (templateBody.sn_all_nb != null) {
								templateBody.createBarcodeForPrint(templateBody.sn_all_nb[new_nb + i - 1]);
							}
							divToPrint = document.getElementById("table2");
							if (i == 1 || i == print_nb * print_page + 1) {
								//初始化-每分頁第一筆資料
								newWin = window.open("", "Print-Window_" + new_nb);
								print_page += 1;
								print_production = "<div>" + divToPrint.innerHTML + "</div>";
							} else {
								print_production += '<div style="page-break-before:always">' + divToPrint.innerHTML + "</div>";
							}
							//分批列印
							if (in_nb == i) {
								newWin.document.open();
								newWin.document.write("<html><head>" + "<title>DTR ERP(" + (new_nb + 1) + " to " + (new_nb + in_nb) + ")</title>"
										+ '<link rel="stylesheet" href="./thirdparty/css/bootstrap-4.4.1.min.css" />' + style.outerHTML + "</head>"
										+ '<body onload="window.print()" class="container text-center" id="main">' + print_production + "</body></html>");
								newWin.document.close(); //完成頁面顯示
								setTimeout(function() {
									newWin.close();
								}, 6500);
								//console.log(newWin.document.getElementById('datepicker1').getElementsByTagName("input"));
							}
						}
						new_nb += in_nb;
						//如果還沒跑完
						if (new_nb < in_total) {
							print_Loop(new_nb, in_total, in_nb);
						} else {
							//跑完的話(恢復日期格式)
							$("#datepicker1 input").removeClass("d-none");
							$("#datepicker2 input").removeClass("d-none");
							$("#datepicker1 div").addClass("d-none");
							$("#datepicker2 div").addClass("d-none");
						}
					}, 3000);
				}

				//初始化(現在數 0)/總筆數/每分頁數(100)
				//日期顯示
				$("#datepicker1 input").addClass("d-none");
				$("#datepicker2 input").addClass("d-none");
				$("#datepicker1 div").removeClass("d-none");
				$("#datepicker2 div").removeClass("d-none");
				print_Loop(0, number_total, print_nb);
			},
			//Rsp-回傳值-指令
			bodyAfter : function(event) {
				console.log("to index success");
				switch (event.r_cellBackOrder) {
				//更新查詢
				case "production_search_update":
					if (event.r_content.templateInfo.body["production_list"] != null && event.r_content.templateInfo.body["production_list"] != "") {
						this.production_list = main.contentData.templateInfo.body["production_list"];
						this.softwareVer_list = main.contentData.templateInfo.body["softwareVer_list"];
						//如果有克製化
						if (main.contentData.templateInfo.body["sn_all_nb"]["sn_list_burn"] != null) {
							this.sn_all_nb = main.contentData.templateInfo.body["sn_all_nb"]["sn_list_burn"];
						} else {
							this.sn_all_nb = main.contentData.templateInfo.body["sn_all_nb"]["sn_list"];
						}
						this.sn_all_list = main.contentData.templateInfo.body["sn_all_list"];
						//this.production_update();
						templateBody.send_search("production");
						templateBody.printDiv2();
					}
					break;
				//只有查詢
				case "production_search":
					if (event.r_content.templateInfo.body["production_list"] != null && event.r_content.templateInfo.body["production_list"] != "") {
						this.production_list = main.contentData.templateInfo.body["production_list"];
						this.production_update();
					}
					break;
				}
			},
		},
		//移除監聽事件
		beforeDestroy : function() {
			console.log("to beforeDestroy event");
			$(document).off("click", "#a_u_group_name select");
			$(document).off("click", "#search_choose input");
			$(document).off("click", "#s_submit");
			$(document).off("click", "#a_c_submit");
			$(document).off("click", "#p_submit");

			$(document).off("click", ".a_submit");
			$(document).off("click", ".a_i_item");
			$(document).off("click", ".from_move");
			$(document).off("click", ".production_ok");

			$(document).off("change", "#ps_sn_burn_nb");
			$(document).off("change", ".ph_wc_line");
			$(document).off("change", ".ph_wpro_id");
			$(document).off("change", ".select_sn");
			$(document).off("focusout", "#client_name");
			$(document).off("focusout", "#barcodeInput");
			$(document).off("focusin", "#barcodeInput");
			$(document).off("keyup", "#barcodeInput");
			$(document).off("click", "#sn_customized_ok");
		},
	});
</script>