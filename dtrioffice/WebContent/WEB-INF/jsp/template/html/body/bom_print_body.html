<script src="./thirdparty/js/jquery-barcode.min.js"></script>
<style id="table2Style">
.font_28 {
	font-size: 28px;
	line-height: 28px;
}

.font_24 {
	font-size: 24px;
	line-height: 24px;
}

.font_20 {
	font-size: 20px;
	line-height: 20px;
}

.font_14 {
	font-size: 14px;
	line-height: 14px;
}

.font_12 {
	font-size: 12px;
	line-height: 12px;
}

.cb_pkg_ch {
	height: 18px;
	width: 18px;
}

#search_table {
	height: 485px;
	border-collapse: separate;
	border-spacing: 0px;
}

[contentEditable=true]:empty:not(:focus):before {
	content: attr(data-text)
}
</style>
<div class="pt-4 m-0 row shadow" id="bom_print_body">
	<div class="col-md-12 p-0">
		<div class="mb-3 text-center">
			<h3>
				<b>生產注意事項</b>
			</h3>
		</div>
		<!-- 查詢功能 -->
		<div class="mb-3 border border-primary rounded shadow bg-light">
			<div class="col p-0">
				<a class="btn btn-sm btn-success" data-toggle="collapse" href="#collapseSearch" role="button" aria-expanded="true" aria-controls="collapseSearch"> 查詢功能 : </a>
			</div>
			<div class="h5 collapse show m-0" id="collapseSearch">
				<div class="col-md-12 p-1 row m-0">
					<div class="col-md-7 p-0 m-0 row border border rounded">
						<div class="col-md-3 p-1">
							<div class="col p-0">產品類型:</div>
							<div class="col p-0">
								<select class="col-12 a_row2" id="s_g_bom_type" name="s_g_bom_type">
									<option value="product">產品類型</option>
									<option value="accessories">配件類型</option>
								</select>
							</div>
						</div>
						<div class="col-md-3 p-1">
							<div class="col p-0">項目群組:</div>
							<div class="col p-0">
								<select class="col-12 a_row2" id="s_g_item" name="s_g_item">
									<option value="">請選擇</option>
								</select>
							</div>
						</div>
						<div class="col-md-3 p-1">
							<div class="col p-0">支項項目:</div>
							<div class="col p-0">
								<select class="col-12 a_row2" id="s_i_item" name="s_i_item">
									<option value="">請選擇</option>
								</select>
							</div>
						</div>
						<div class="col-md-3 p-1">
							<div class="col p-0">產品型號:</div>
							<div class="col p-0">
								<input class="col-12" type="text" id="s_model" name="s_model" placeholder="Ex:型號123456" required />
							</div>
						</div>
						<div class="col-md-3 p-1">
							<div class="col p-0">BOM料號:</div>
							<div class="col p-0">
								<input class="col-12" type="text" id="s_bom_number" name="s_bom_number" placeholder="Ex:10-901-123456" required autofocus />
							</div>
						</div>
						<div class="col-md-6 p-1 d-none">
							<div class="col p-0">製令單號:</div>
							<div class="col p-0">
								<input class="col-12" type="text" id="s_order_id" name="s_order_id" placeholder="Ex:A513-8745940-123" disabled="disabled" />
							</div>
						</div>
						<div class="col-md-12 p-0 row m-0 justify-content-center">
							<div class="row m-0 justify-content-center col-md-3 p-2">
								<button id="s_l_submit" class="col-md-10 btn btn-info btn-block m-1" type="submit">Step1.條件登記</button>
							</div>
							<div class="row m-0 justify-content-center col-md-3 p-2">
								<button id="s_submit" class="col-md-10 btn btn-primary btn-block m-1" type="submit">Step2.查詢條件</button>
							</div>
							<div class="row m-0 justify-content-center col-md-3 p-2">
								<button id="s_c_submit" class="col-md-10 btn btn-warning btn-block m-1" type="button">清除條件</button>
							</div>
						</div>
					</div>
					<div class="col-md-5 p-0 m-0 row rounded border">
						<div class="" id="s_l_list">
							<div class="text-left mb-2 mt-2" style="overflow-wrap: break-word;">條件清單:</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- 功能:查詢結果  /修改 -->
		<div class="mb-3 border border-primary rounded shadow bg-light">
			<div class="col p-0">
				<a class="btn btn-sm btn-success" data-toggle="collapse" href="#collapseFinish" role="button" aria-expanded="true" aria-controls="collapseFinish"> 查詢結果 : </a>
			</div>
			<div class="collapse show" id="collapseFinish">
				<div class="p-1 mb-2 mt-2 m-0 row">
					<b>(<font class="text-danger">紅字=試產</font> / <font class="text-success">綠字=可量產</font> / <font class="bg-white">白亮底色=已使用過)</font></b>
					<div id="search_choose" class="row m-0 mb-2">
						<div class="text-left">
							<b>顯示名稱-></b>
						</div>
					</div>
					<!-- 顯示內容 -->
					<table id="search_table" class="border border-secondary table table-sm table-hover table-striped table-bordered table-responsive">
						<thead>
							<tr id="search_thead" class="table-primary h5">
								<th scope="col" style="min-width: 80px;">功能</th>
								<th scope="col" style="min-width: 40px;">筆</th>
							</tr>
						</thead>
						<tbody id="search_tbody"></tbody>
					</table>
					<!-- 換頁 -->
					<div id="page-items" aria-label="Page" class="col">
						<ul class="pagination justify-content-center m-0">
							<li class="page-item p_p disabled"><a id="p_p" class="page-link" href="#" onclick="return templateBody.change_page(this);">Previous 10 </a></li>
							<li class="page-item p_nb p1 active"><a id="p1" class="page-link" href="#" onclick="return templateBody.change_page(this);">1</a></li>
							<li class="page-item p_nb p2"><a id="p2" class="page-link" href="#" onclick="return templateBody.change_page(this);">2</a></li>
							<li class="page-item p_nb p3"><a id="p3" class="page-link" href="#" onclick="return templateBody.change_page(this);">3</a></li>
							<li class="page-item p_nb p4"><a id="p4" class="page-link" href="#" onclick="return templateBody.change_page(this);">4</a></li>
							<li class="page-item p_nb p5"><a id="p5" class="page-link" href="#" onclick="return templateBody.change_page(this);">5</a></li>
							<li class="page-item p_nb p6"><a id="p6" class="page-link" href="#" onclick="return templateBody.change_page(this);">6</a></li>
							<li class="page-item p_nb p7"><a id="p7" class="page-link" href="#" onclick="return templateBody.change_page(this);">7</a></li>
							<li class="page-item p_nb p8"><a id="p8" class="page-link" href="#" onclick="return templateBody.change_page(this);">8</a></li>
							<li class="page-item p_nb p9"><a id="p9" class="page-link" href="#" onclick="return templateBody.change_page(this);">9</a></li>
							<li class="page-item p_nb p10"><a id="p10" class="page-link" href="#" onclick="return templateBody.change_page(this);">10</a></li>
							<li class="page-item p_n disabled"><a id="p_n" class="page-link" href="#" onclick="return templateBody.change_page(this);">Next 10 </a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<!-- 生產注意事項 -->
		<div class="mb-3 border border-primary rounded shadow bg-light">
			<div class="col p-0">
				<a class="btn btn-sm btn-success" data-toggle="collapse" href="#collapseAdded" role="button" aria-expanded="false" aria-controls="collapseAdded">生產注意事項 列印預覽 : </a>
			</div>
			<div class="collapse show container" id="collapseAdded">
				<!-- 設定[注意事項] -->
				<div class="p-1 row m-0 mb-2 mt-2">
					<div class="col-md-6 row m-0 p-0 text-center font_20 border border-dark">
						<div class="col-md-2 pt-2 p-0">限制 :</div>
						<div class="col-md-10 p-2" id="" style="color: red;">
							[可裝配 <b id="needUseNb">42</b> 項] [不裝配 <b id="notUseNb">28</b> 項]
						</div>
					</div>
					<div class="col-2 row m-0 p-0 text-center"></div>
					<div class="col-md-4 row m-0 p-0 text-center font_20 border border-dark">
						<div class="col-md-4 p-2">類型 :</div>
						<div class="col-md-4 p-1" id="">
							<select id="a_u_kind" class="" id="inlineFormCustomSelect">
								<option value="0" selected>技轉中</option>
								<option value="1">可量產</option>
							</select>
						</div>
						<div class="col-md-4 p-1" id="">
							<button class="btn-sm btn btn-primary btn-block" id="p_submit3" type="button">修正</button>
						</div>
					</div>
				</div>
				<!-- 生產注意事項 -->
				<div id="collapseAddedPrint" class="border border-dark" style="background: white; height: 1455px; width: 1110px; overflow: hidden; margin: auto;">
					<!-- [標題] -->
					<div id="snList" class="border border-dark p-0 m-0 text-left" style="height: 282px; width: 100%">
						<div class="border border-dark h1 mb-0 p-2 text-center font-weight-bolder">生產注意事項</div>
						<div class="row m-0 ">
							<div class="col-1 p-1 pt-2 border border-dark h3 mb-0 font-weight-bolder">工單</div>
							<div class="col-3 p-0 border border-warning font_28">
								<input id="a_u_id" value="" type="text" class="col-12 p-1 border border-warning rounded" title="製令單">
							</div>
							<div class="col-1 p-1 pt-2 border border-dark h3 mb-0 font-weight-bolder">訂單</div>
							<div class="col-3 p-0 border border-warning font_28">
								<input id="a_u_o_id" value="" type="text" class="col-12 p-1 border border-warning rounded" title="客戶訂單">
							</div>
							<div class="col-2 p-1 pt-2 border border-dark h3 mb-0 font-weight-bolder">預計出貨</div>
							<div class="col-2 p-0 border border-warning font_28">
								<input id="a_u_o_date" value="" type="text" class="col-12 p-1 border border-warning rounded" title="預計出貨日期">
							</div>
						</div>
						<div class="row m-0">
							<div class="col-2 p-1 pt-2 border border-dark h3 mb-0 font-weight-bolder">客戶 / 國家</div>
							<div class="col-2 p-0 border border-warning font_28">
								<input id="a_u_c" value="" type="text" class="col-12 p-1 border border-warning rounded can_rm" title="客戶名稱">
							</div>
							<div class="col-2 p-0 border border-warning font_28">
								<input id="a_u_country" value="" type="text" class="col-12 p-1 border border-warning rounded can_rm" title="客戶國家">
							</div>
							<div class="col-2 p-1 pt-2 border border-dark h3 mb-0 font-weight-bolder">數量</div>
							<div class="col-2 p-0 border border-warning font_28">
								<input id="a_u_nb" value="1" type="number" class="col-12 p-1 pr-0 border border-warning rounded" min="0">
							</div>
							<div class="col-2 p-1 pt-2 border border-dark font_28 text-center" id="kind1"></div>
						</div>
						<div class="row m-0">
							<div class="col-2 p-1 border border-dark  mb-0 ">
								<p class="h3 font-weight-bolder m-0" style="line-height: 21px;">產品BOM號</p>
								<p class="text-muted small m-0">(公司BOM號/客戶BOM號)</p>
							</div>
							<div class="col-3 p-0 border border-warning font_28" title="可支援 公司BOM/客戶BOM">
								<input id="a_u_bom_number" value="" type="text" class="col-12 p-1 border border-warning rounded can_rm" title="公司/客戶(BOM)">
							</div>
							<div id="a_u_bom_id" class="d-none">632</div>
							<div class="col-1 p-1 border border-dark h3 mb-0 font-weight-bolder">型號</div>
							<div id="a_u_model" class="col-2 p-1 pt-2 border border-dark font_28 can_rm"></div>
							<div class="col-2 p-1 pt-2 border border-dark h3 mb-0 font-weight-bolder font_24">主板(硬)版本</div>
							<div id="a_u_version_bios" class="col-2 p-1 pt-2 border border-dark font_28 can_rm"></div>
						</div>
						<div class="row m-0">
							<div class="col-2 p-1 border border-dark h3 mb-0 font-weight-bolder">PM備註</div>
							<div class="col-10 p-0 border border-dark font_20" style="height: 67px">
								<div id="a_u_note" class="col-12 p-1 border border-dark rounded" style="overflow: hidden; height: 65px;"></div>
							</div>
						</div>
					</div>
					<!-- [產品內容 需裝配] -->
					<div id="setHardware" class="border border-dark p-0 m-0 text-left" style="height: 720px; width: 100%; overflow: hidden;">
						<div class="row m-0">
							<div class="listLeft col-6 p-1">
								<div class="p-1 border-bottom border-right border-secondary itemSample ui-sortable-handle" style="height: 34px; display: none; overflow: hidden;">
									<div class="m-0 font_20" style="white-space: nowrap;">
										<span class="name font-weight-bolder pr-1"></span> <span class="content"></span> <span class="amount"></span>
									</div>
								</div>
							</div>
							<div class="listRight col-6 p-1"></div>
						</div>
					</div>
					<!-- [產品內容 不裝配] -->
					<div id="setHardware_notUse" class="border border-dark p-0 m-0" style="height: 131px; width: 100%; overflow: hidden;">
						<div class="row m-0 list_notUse">
							<div class=" row m-1 font_24">
								<div class="name font-weight-bolder pr-1">注意!!不裝配 :</div>
							</div>
							<div class="d-none itemSample_notUse row m-1 font_20 border-bottom border-right border-secondary">
								<div class="name font-weight-bolder pr-1"></div>
								<div class="content pr-1"></div>
								<div class="amount"></div>
							</div>
						</div>
					</div>
					<!-- 包裝型態 -->
					<div id="" class="border border-dark p-0 m-0" style="height: 140px; width: 100%; overflow: hidden;">
						<div class="row m-0 p-1 font_20">
							<div class="col-1 font-weight-bolder p-0 pt-1">
								包裝<br>形態
							</div>
							<div class="col-11 p-0">
								<div id="pkg_1" class="itemSample float-left col-4 row p-1 m-0">
									<div id="cb_pkg_1" class="cb_pkg p-0 border border-secondary rounded" style="background-color: #e9ecef;">
										<input class="cb_pkg_ch m-2" type="checkbox">
									</div>
									<div class="cb_pkg_name border col-10 font_20 p-1" contenteditable="true" style="white-space: nowrap; overflow: hidden;">Power cord</div>
								</div>
								<div id="pkg_2" class="itemSample float-left col-4 row p-1 m-0">
									<div id="cb_pkg_2" class="cb_pkg p-0 border border-secondary rounded" style="background-color: #e9ecef;">
										<input class="cb_pkg_ch m-2" type="checkbox">
									</div>
									<div class="cb_pkg_name border col-10 font_20 p-1" contenteditable="true" style="white-space: nowrap; overflow: hidden;">BOG</div>
								</div>
								<div id="pkg_3" class="itemSample float-left col-4 row p-1 m-0">
									<div id="cb_pkg_3" class="cb_pkg p-0 border border-secondary rounded" style="background-color: #e9ecef;">
										<input class="cb_pkg_ch m-2" type="checkbox">
									</div>
									<div class="cb_pkg_name border col-10 font_20 p-1" contenteditable="true" style="white-space: nowrap; overflow: hidden;">License</div>
								</div>
								<div id="pkg_4" class="itemSample float-left col-4 row p-1 m-0">
									<div id="cb_pkg_4" class="cb_pkg p-0 border border-secondary rounded" style="background-color: #e9ecef;">
										<input class="cb_pkg_ch m-2" type="checkbox">
									</div>
									<div class="cb_pkg_name border col-10 font_20 p-1" contenteditable="true" style="white-space: nowrap; overflow: hidden;">BOX Label</div>
								</div>
								<div id="pkg_5" class="itemSample float-left col-4 row p-1 m-0">
									<div id="cb_pkg_5" class="cb_pkg p-0 border border-secondary rounded" style="background-color: #e9ecef;">
										<input class="cb_pkg_ch m-2" type="checkbox">
									</div>
									<div class="cb_pkg_name border col-10 font_20 p-1" contenteditable="true" style="white-space: nowrap; overflow: hidden;">Bulk Pack</div>
								</div>
								<div id="pkg_6" class="itemSample float-left col-4 row p-1 m-0">
									<div id="cb_pkg_6" class="cb_pkg p-0 border border-secondary rounded" style="background-color: #e9ecef;">
										<input class="cb_pkg_ch m-2" type="checkbox">
									</div>
									<div class="cb_pkg_name border col-10 font_20 p-1" contenteditable="true" style="white-space: nowrap; overflow: hidden;">Retail Pack</div>
								</div>
								<div id="pkg_7" class="itemSample float-left col-4 row p-1 m-0">
									<div id="cb_pkg_7" class="cb_pkg p-0 border border-secondary rounded" style="background-color: #e9ecef;">
										<input class="cb_pkg_ch m-2" type="checkbox">
									</div>
									<div class="cb_pkg_name border col-10 font_20 p-1" contenteditable="true" style="white-space: nowrap; overflow: hidden;">作業系統OS</div>
								</div>
								<div id="pkg_8" class="itemSample float-left col-4 row p-1 m-0">
									<div id="cb_pkg_8" class="cb_pkg p-0 border border-secondary rounded" style="background-color: #e9ecef;">
										<input class="cb_pkg_ch m-2" type="checkbox">
									</div>
									<div class="cb_pkg_name border col-10 font_20 p-1" contenteditable="true" style="white-space: nowrap; overflow: hidden;">NA1</div>
								</div>
								<div id="pkg_9" class="itemSample float-left col-4 row p-1 m-0">
									<div id="cb_pkg_9" class="cb_pkg p-0 border border-secondary rounded" style="background-color: #e9ecef;">
										<input class="cb_pkg_ch m-2" type="checkbox">
									</div>
									<div class="cb_pkg_name border col-10 font_20 p-1" contenteditable="true" style="white-space: nowrap; overflow: hidden;">NA2</div>
								</div>
							</div>
						</div>
					</div>
					<!-- 備註 -->
					<div id="" class="border border-dark p-0 m-0" style="height: 160px; width: 100%; overflow: hidden;">
						<div class="row m-0 p-1 font_20" style="height: 100%">
							<div class="col-1 font-weight-bolder p-0">
								生管<br>備註
							</div>
							<div class="col-11 p-0" style="height: 100%">
								<textarea id="a_u_note2" rows="7" class="col-12 p-1 border border-warning rounded"></textarea>
							</div>
						</div>
					</div>
					<!-- 類型 -->
					<div id="fromTo" class="border border-dark p-0 m-0" style="height: 22px; width: 100%; font-size: 12px;">
						<div class="row m-0 text-muted">
							<div class="col-1 p-0 border border-dark">類型/原BOM:</div>
							<div class="col-1 p-0 border border-dark" id="c1_bom_type"></div>
							<div class="col-3 p-0 border border-dark" id="c1_bom_number"></div>
							<div class="col-7 p-0 border border-dark text-right" id="c1_note" title=""></div>
							<div class="d-none" id="a_u_bom_principal" title=""></div>
							<div class="d-none" id="a_u_mfg_part_no" title=""></div>
							<div class="d-none" id="a_u_parts_no" title=""></div>

						</div>
					</div>
				</div>
			</div>
			<div class="row mb-3 mt-3 m-0" id="printBtn">
				<div class="col-md-3">
					<div class="mr-1 ml-1 float-right row border border-primary rounded" style="padding-right: 0px;">
						<div id="a_u_production" class="cb_pkg p-0 border border-secondary rounded" style="background-color: #e9ecef;">
							<input type="checkbox" checked="checked" class="m-2 cb_pkg_ch">
						</div>
						<div class="border" style="padding: 5px;">
							<div class="" style="height: 24px;">
								<b>登記生產</b>
							</div>
						</div>
					</div>
				</div>
				<div class="col-md-2">
					<div class="col-md-8 p-1 container">
						<button id="p_submit" class="btn btn-info btn-block" type="button">列印內容</button>
					</div>
				</div>
				<div class="col-md-2">
					<div class="col-md-8 p-1 container">
						<button id="m_s_submit" class="btn btn-primary btn-block" type="button">回生管排程</button>
					</div>
				</div>
				<div class="col-md-2">
					<div class="col-md-8 p-1 container">
						<button id="a_c_submit" class="btn btn-warning btn-block" type="button">清除內容</button>
					</div>
				</div>
				<div class="col-md-3">
					<b class="text-danger">注意 : [登記生產]過4個月後<br>製令單 將自動 [標記廢止]!!
					</b>
				</div>
			</div>
		</div>
		<!-- 生產注意事項-說明 -->
		<div class="border border-primary rounded shadow bg-light">
			<div class="col p-0">
				<a class="btn btn-sm btn-success" data-toggle="collapse" href="#collapseEx" role="button" aria-expanded="false" aria-controls="collapseEx">生產注意事項 (一鍵化)說明: </a>
			</div>
			<div class="collapse container bg-white" id="collapseEx">
				<p>***(一鍵)建立注意事項***</p>
				<p>***如果發現.鼎新ERP[物料]定義不標準,請通知採購部->文管部->即可修正***</p>
				<table class="border border-secondary table table-sm table-hover table-striped table-bordered table-responsive">
					<thead>
						<tr>
							<th>生產注意事項:對應欄位</th>
							<th>來源</th>
							<th style="width: 41%;">參照欄位</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>工單號</td>
							<td>延展:生管排程</td>
							<td>工單號</td>
						</tr>
						<tr>
							<td>訂單</td>
							<td>延展:生管排程/鼎新ERP</td>
							<td>製令備註</td>
						</tr>
						<tr>
							<td>訂單/客戶/國家</td>
							<td>延展:生管排程/鼎新ERP</td>
							<td>製令備註[(請使用/區分) 訂單/客戶/國家]</td>
						</tr>
						<tr>
							<td>預計出貨</td>
							<td>延展:生管排程</td>
							<td>預計完工日</td>
						</tr>
						<tr>
							<td>數量</td>
							<td>延展:生管排程</td>
							<td>預計產量</td>
						</tr>
						<tr>
							<td>產品BOM號</td>
							<td>延展:生管排程</td>
							<td>產品品號[匹配]產品BOM號</td>
						</tr>
						<tr>
							<td>包裝型態.1.Power cord</td>
							<td>鼎新ERP</td>
							<td>製令工單內 [條件](料號名稱)含有:POWER CORD & 數量0以上</td>
						</tr>
						<tr>
							<td>包裝型態.2.BOG</td>
							<td>鼎新ERP</td>
							<td>製令工單與訂單號 [條件](訂單號) 不為空 說明書</td>
						</tr>
						<tr>
							<td>包裝型態.3.License</td>
							<td>鼎新ERP</td>
							<td>製令工單內 [條件](料號)含有:50-100- & 數量0以上</td>
						</tr>
						<tr>
							<td>包裝型態.4.BOX Lable</td>
							<td>鼎新ERP</td>
							<td>製令工單內 [條件](料號名稱)含有: BOX label & 數量0以上</td>
						</tr>
						<tr>
							<td>包裝型態.5.Bulk Pack</td>
							<td>鼎新ERP</td>
							<td>製令工單內 [條件](料號名稱)含有: BULK CARTON & 數量0以上</td>
						</tr>
						<tr>
							<td>包裝型態.6.Retail Pack</td>
							<td>鼎新ERP</td>
							<td>與.5.Bulk Pack 相反</td>
						</tr>
						<tr>
							<td>包裝型態.7.作業系統OS</td>
							<td>鼎新ERP</td>
							<td>[來源]不確定</td>
						</tr>
						<tr>
							<td>生管備註</td>
							<td>鼎新ERP</td>
							<td>製令工單內 [條件]訂單生產加工組裝包裝備註+生產注意事項</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
	<!-- 浮動電梯 -->
	<div class="text-center fixed-bottom m-3 " style="width: 140px; font-family: Microsoft JhengHei; font-size: 16px; left: auto;">
		<div id="top" class="shadow from_move row p-2 m-2 bg-light border border-primary rounded" style="cursor: pointer;">
			<img class="col-md-3 pl-0 pr-0" alt="top" src="./thirdparty/images/move_arrow.gif" style="transform: rotate(-135deg); max-width: 25px;">
			<div class="col-md-9 pr-0" style="max-width: 80px;">Top</div>
		</div>
		<div id="collapseAdded_1" class="shadow from_move row p-2 m-2 bg-light border border-primary rounded" style="cursor: pointer;">
			<img class="col-md-3 pl-0 pr-0" alt="注意事項" src="./thirdparty/images/move_arrow.gif" style="transform: rotate(88deg); max-width: 25px;">
			<div class="col-md-9 pr-0" style="max-width: 80px;">注意事項</div>
		</div>
		<div id="collapseAdded_2" class="shadow from_move row p-2 m-2 bg-light border border-primary rounded" style="cursor: pointer;">
			<img class="col-md-3 pl-0 pr-0" alt="列印內容" src="./thirdparty/images/move_arrow.gif" style="transform: rotate(88deg); max-width: 25px;">
			<div class="col-md-9 pr-0" style="max-width: 80px;">列印內容</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	console.log("bom_print_body");
	templateBody = new Vue({
		el : "#bom_print_body",
		data : {
			l_search_thead : "", //鎖定查詢
			search_list : "",
			group_list : "",
			item_list : "",
			group_acc_list : "",
			item_acc_list : "",
			item_nb_max : 0, //最大ID數
			//分頁功能
			page_max : 100,//當前本批 筆數
			page_max_total : 100,//最大總數
			page_batch : 0,//第幾批
			page_batch_total : 100,//每批間格值
			page_every : 10,//當前每頁筆數
			page_stay : 1,//當前頁數
			s_0 : 0,//當前產品ID
			d_1 : '',//當前的 投線日
			d_2 : '',//當前的 出貨日
			needUseNb : 42,//限制 可裝配
			notUseNb : 28,//限制 不裝配
			current_report : "自訂",//當前報表來源
			a_u_note2_def : "NPI_EE/NPI_ME及PLT人員須到場確認技轉狀況，產線須提出技轉報告!",//預設值(如果 為技轉中)
		},
		created : function() {
			//初始化

			console.log(main.contentData.templateInfo.body);
			this.group_list = main.contentData.templateInfo.body["group_list"];
			this.item_list = main.contentData.templateInfo.body["item_list"];
			this.item_acc_list = main.contentData.templateInfo.body["item_acc_list"];

			this.search_list = main.contentData.templateInfo.body["list"];
			this.item_nb_max = main.contentData.templateInfo.body["group_list"].length + 1;
			$("#group_id_0").text(this.item_nb_max);
			$("#a_item").attr("group_id", this.item_nb_max);

			//t_choose
			var min_width = 100;
			for (var i = 0; i < this.search_list[0].length; i++) {
				var choose_check = '[<div class="text-left form-check">';
				choose_check += '<input class="form-check-input" type="checkbox" value="" id="s_' + i + '" checked>';
				choose_check += '<label class="form-check-label" for="s_' + i + '">' + this.search_list[0][i] + "</label>";
				choose_check += "</div>]";
				$("#search_choose").append(choose_check);
			}
			//t_header
			for (var i = 0; i < this.search_list[0].length; i++) {
				if (i == 2 || i == 3 || i == 5 || i == 6) {
					min_width = 180;
				}
				if (i == 1 || i == 4) {
					min_width = 150;
				}
				if (i == 10) {
					min_width = 100;
				}
				$("#search_thead").append('<th style="min-width: ' + min_width + 'px;" class="s_' + i + '" scope="col">' + this.search_list[0][i] + "</th>");
				min_width = 80;
			}
			//t_body
			this.search_update();
			//t_body_group
			this.group_choose();
			//建立 選項
			this.group_item_choose("s_g_item", -1, this.item_list);
			this.group_item_choose("a_g_item_0", 0, this.item_list);

			//動態監聽顯示Table 物件 查看開關
			$(document).on("click", "#search_choose input", function(event) {
				templateBody.search_choose(event);
			});
			//查詢監聽
			$(document).on("click", "#s_submit", function(event) {
				//頁數-重製分頁
				templateBody.change_page_init();
				templateBody.send_search("");
			});
			//清除修改
			$(document).on("click", "#a_c_submit", function(event) {
				templateBody.rm_added();
			});
			$(document).on("click", "#p_submit", function(event) {
				//頁數-重製分頁
				templateBody.change_page_init();
				templateBody.send_search("checked");
			});
			//回排程
			$(document).on("click", "#m_s_submit", function(event) {
				templateNav.jsonSend("./production_management.do", "update_body");
			});

			//移動
			$(document).on("click", ".from_move", function(event) {
				templateBody.from_move(event);
			});
			//切換群組項目 監聽
			$(document).on("change", "#s_g_bom_type", function(event) {
				if ($("#s_g_bom_type").val() == "product") {
					templateBody.group_item_choose("s_g_item", -1, templateBody.item_list);
					templateBody.group_item_choose("a_g_item_0", 0, templateBody.item_list);
				} else {
					templateBody.group_item_choose("s_g_item", -1, templateBody.item_acc_list);
					templateBody.group_item_choose("a_g_item_0", 0, templateBody.item_acc_list);
				}
				s_i_item = "<option value=''>請選擇</option>";
				$("#s_i_item").empty();
				$("#s_i_item").append(s_i_item);
			});

			//切換項目 監聽
			$(document).on("change", "#s_g_item", function(event) {
				if ($("#s_g_bom_type").val() == "product") {
					templateBody.item_choose(event, -1, templateBody.item_list);
				} else {
					templateBody.item_choose(event, -1, templateBody.item_acc_list);
				}
			});

			//新增監聽
			$(document).on("click", "#a_item", function(event) {
				templateBody.added_item();
			});
			// 條件清除
			$(document).on("click", "#s_c_submit", function(event) {
				templateBody.rm_select();
			});
			//只單獨修正
			$(document).on("click", "#p_submit3", function(event) {
				templateBody.send_search('kind');
			});

			//條件鎖定
			$(document).on("click", "#s_l_submit", function(event) {
				templateBody.lk_select();
			});
			//勾選條件設定
			$(document).on("click", ".cb_pkg", function(event) {
				console.log(event.currentTarget.id);
				if (event.currentTarget.id != '') {
					var key = event.currentTarget.id;
					if ($('#' + key + " input").attr('checked') == 'checked') {
						$('#' + key + " input").prop('checked', false);
						$('#' + key + " input").removeAttr('checked');
					} else {
						$('#' + key + " input").prop('checked', true);
						$('#' + key + " input").attr('checked', 'checked');
					}
				}
			});
			//日期
			$(document).ready(function(event) {
				$("#a_u_o_date").datepicker({
					dateFormat : "yy-mm-dd",
					minDate : 0,
				});
			});
			var lastContent = "";

		},
		//網頁掛載完後自動呼叫
		mounted : function() {
			//===自動化===
			if (main.tempAutoBomPrint != null && main.tempAutoBomPrint.autoStepCheck == true) {
				setTimeout(function() {
					$('#s_bom_number').val(main.tempAutoBomPrint.orderBomId);
					$('#s_order_id').val(main.tempAutoBomPrint.orderId);

					$('#s_l_submit').trigger("click");
					$('#s_submit').trigger("click");
					main.tempAutoBomPrint.autoStep1 = true;
				}, 500);
			}
		},
		methods : {
			search_choose : function(event) {
				console.log(event.target.checked);
				if (!event.target.checked) {
					$("#search_thead ." + event.target.id).hide();
					$("#search_tbody ." + event.target.id).hide();
				} else {
					$("#search_thead ." + event.target.id).show();
					$("#search_tbody ." + event.target.id).show();
				}
			},
			//查詢更新
			search_update : function() {
				$("#search_tbody").empty();
				//頁數-刷新
				this.change_page_update();
				//t_body
				var checked = 6;
				var kind = 7;
				for (var i = 1; i < this.search_list.length; i++) {
					//頁數-每頁顯示(不再顯示範圍內則隱藏)
					var page_group = this.change_page_btn(i);
					//功能
					var s_list = this.search_list[i][0];

					var a_submit = '<div class="md-6">';
					a_submit += '<button user_id="' + s_list + '" class="btn btn-warning btn-sm btn-block a_submit">';
					a_submit += "預覽</button></div>";
					//有列印過的-
					var success_color = "bg-light";
					//只技轉中
					var text_r = " text-danger";
					//可量產
					var text_g = " text-success";

					this.search_list[i][checked] != "" ? success_color = "bg-light font-weight-bold" : success_color = "";
					this.search_list[i][kind] == 0 ? success_color += text_r : success_color += text_g;
					$("#search_tbody").append(
							'<tr class=" page_all  t_row'+s_list+' '+page_group+' "style="white-space: nowrap;"><th class="ml-0 col-md-12 row">' + a_submit
									+ '</th></tr>');
					//計數量
					$("#search_tbody .t_row" + s_list).append("<td >" + i + "</td>");

					for (var j = 0; j < this.search_list[i].length; j++) {
						var color = '';
						if (j == 1)
							color = success_color;

						$("#search_tbody .t_row" + s_list).append("<td class='s_" + j + " "+color+"' >" + this.search_list[i][j] + "</td>");
					}
				}
				//預覽監聽
				$(document).off("click", ".a_submit");
				$(document).on("click", ".a_submit", function(event) {
					templateBody.choose_show("資料顯示", event);

					setTimeout(function() {
						$("html,body").animate({
							scrollTop : 1020
						}, 'slow');
					}, 500);
				});
				//===自動化===
				setTimeout(function() {
					if (templateBody.search_list.length == 2 && //有資料
					main.tempAutoBomPrint.autoStepCheck && //有自動化
					main.tempAutoBomPrint.autoStep1 && //有來自 生管排程
					main.tempAutoBomPrint.autoStep2) {//有該製令單 配對
						console.log(main.tempAutoBomPrint);
						$("#search_tbody .a_submit").trigger("click");
						$('#a_u_id').val(main.tempAutoBomPrint.orderId);//工單號
						$('#a_u_o_date').val(main.tempAutoBomPrint.orderEndDate);//預計出貨日
						$('#a_u_o_id').val(main.tempAutoBomPrint.orderNo);//訂單
						$('#a_u_c').val(main.tempAutoBomPrint.orderer);//客戶
						$('#a_u_country').val(main.tempAutoBomPrint.orderCountry);//國家
						$('#a_u_nb').val(main.tempAutoBomPrint.orderQty);//數量
						
						//packagePC = Power cord
						if (main.tempAutoBomPrint.packagePC != null) {
							$('#pkg_1 .cb_pkg').trigger("click");
							$('#pkg_1 .cb_pkg_name').text(main.tempAutoBomPrint.packagePC);
						}
						//packageBOG = BOG
						if (main.tempAutoBomPrint.packageBOG != null) {
							$('#pkg_2 .cb_pkg').trigger("click");
						}
						//packageL = License
						if (main.tempAutoBomPrint.packageL != null) {
							$('#pkg_3 .cb_pkg').trigger("click");
							$('#pkg_3 .cb_pkg_name').text(main.tempAutoBomPrint.packageL);
						}
						//packageBL = BOX Label
						if (main.tempAutoBomPrint.packageBL != null) {
							$('#pkg_4 .cb_pkg').trigger("click");
							$('#pkg_4 .cb_pkg_name').text(main.tempAutoBomPrint.packageBL);
						}
						//packageBP = Bulk Pack
						if (main.tempAutoBomPrint.packageBP != null) {
							$('#pkg_5 .cb_pkg').trigger("click");
						}
						//packageBP = Retail Pack
						if (main.tempAutoBomPrint.packageRP != null) {
							$('#pkg_6 .cb_pkg').trigger("click");
						}
						if ($('#a_u_note2').val() != "") {
							$('#a_u_note2').val($('#a_u_note2').val() + "\n" + main.tempAutoBomPrint.noteMoc);
						} else {
							$('#a_u_note2').val(main.tempAutoBomPrint.noteMoc);
						}
						if (main.tempAutoBomPrint.aubomnumber != "") {
							$('#a_u_bom_number').val(main.tempAutoBomPrint.aubomnumber);//客戶BOM
						}
					}
					//初始化
					main.tempAutoBomPrint = {
						orderId : "",//製令單號
						orderEndDate : "",//預計出貨
						orderBomId : "",//產品ID
						orderQty : 0,//數量
						orderNo : "",//訂單號
						orderer : "",//訂購人
						orderCountry : "",//訂單國家
						packagePC : "",//Power cord
						packageBOG : "",//說明書-有客戶訂單則需要有
						packageL : "",
						packageBL : "",
						packageBP : "",
						packageRP : "",
						packageOS : "",
						noteMoc : "",
						aubomnumber : "",
						autoStepCheck : false,
						autoStep1 : false,
						autoStep2 : false,
						autoStep3 : false,
						autoStep4 : false,
					}
				}, 2500);
			},
			//選擇群組-並建立監聽
			group_choose : function() {
				var group = "";
				$("#a_u_group_name select").empty();
				group += '<option value="">請選擇</option>';
				$.each(this.search_group, function(index, val) {
					group += "<option value=" + val + ">" + index + "</option>";
				});
				$("#a_u_group_name select").append(group);

				$(document).on("change", "#a_u_group_name select", function(event) {
					$("#a_u_group_id").text(event.target.value);
				});
			},
			//移動電梯
			from_move : function(event) {
				console.log(event.currentTarget.id);
				switch (event.currentTarget.id) {
				case "top":
					setTimeout(function() {
						$("html,body").animate({
							scrollTop : 80
						}, 'slow');
					}, 500);
					break;
				case "collapseAdded_1":
					setTimeout(function() {
						$("html,body").animate({
							scrollTop : 1020
						}, 'slow');
					}, 500);
					break;
				case "collapseAdded_2":
					setTimeout(function() {
						$("html,body").animate({
							scrollTop : 2020
						}, 'slow');
					}, 500);
					break;
				default:
					break;
				}
			},
			//選擇項目
			item_choose : function(event, who, item_list) {
				var s_i_item = "";
				for (var i = 0; i < item_list.length; i++) {
					if (item_list[i][0] == event.target.value) {
						var value_i = "";
						//項目
						if (item_list[i][2] == 1) {
							value_i += "--| ";
							for (var j = 4; j < item_list[i].length - 1; j++) {
								value_i += item_list[i][j] + " | ";
							}
							value_i += "--";
							s_i_item += "<option value=''>" + value_i + "</option>";
						} else {
							//內容
							value_i += "| ";
							for (var j = 4; j < item_list[i].length - 1; j++) {
								value_i += item_list[i][j] + " | ";
							}
							s_i_item += "<option value='" + item_list[i][2] + "'>" + value_i + "</option>";
						}
					}
				}
				//沒選擇的話
				if (s_i_item == "") {
					s_i_item = "<option value=''>請選擇</option>";
				}
				//如果是 "新增選擇" 的話 a_i_item_
				if (who > -1) {
					$("#item_id_" + who).text("");
					$("#item_group_id_" + who).text(event.target.value);
					$("#a_i_item_" + who).empty();
					$("#a_i_item_" + who).append(s_i_item);
				} else {
					//如果是 "查詢選擇" 的話 s_i_item
					$("#s_i_item").empty();
					$("#s_i_item").append(s_i_item);
				}
			},
			//選擇 群組-項目
			group_item_choose : function(id, def, item) {
				//s_choose s_g_item
				var s_g_item = "<option value=''>請選擇</option>";
				var group_name = "";
				for (var i = 0; i < item.length; i++) {
					if (group_name != item[i][1]) {
						s_g_item += "<option value='" + item[i][0] + "'>" + item[i][1] + "</option>"; //群組
						group_name = item[i][1];
					}
				}
				$("#" + id).empty();
				$("#" + id).append(s_g_item);
			},
			//更新 項目ID
			item_one_choose : function(event) {
				$("#item_id_" + event.target.attributes.item_id.value).text(event.target.value);
			},
			//清除新增/修該內容
			rm_added : function() {

				//輸入清除
				$('#a_u_country').val("");
				$('#a_u_note').text("");
				$('#a_u_note2').val("");

				$('#a_u_id').val("");
				$('#a_u_c').val("");
				$('#a_u_o_id').val("");
				$('#a_u_o_date').val("");
				$('#a_u_nb').val(1);
				//清除設定
				$('.can_rm').text("");
				//清除選取
				$('.itemSample label input').prop('checked', false);
				$("#group_number_0").val(1);
				$("#setHardware  .item").remove();
				$("#setHardware_notUse  .item_notUse").remove();

			},
			//清除選擇
			rm_select : function() {
				$("#s_l_list").empty();
				$("#s_l_list").append('<div class="text-left mb-2 mt-2">條件清單:</div>');
				$("#s_model").val("");
				$("#s_bom_number").val("");
				$("#s_order_id").val("");
				$("#s_g_item").val("").trigger("change");
			},
			//鎖定~
			lk_select : function() {
				//暗碼
				var lk = "{";
				lk += "'g_item':'" + $("#s_g_item").val() + "',";
				lk += "'i_item':'" + $("#s_i_item").val() + "',";
				lk += "'p_model':'" + $("#s_model").val() + "',";
				lk += "'order_id':'" + $("#s_order_id").val() + "',";
				if ($("#s_l_list div").length < 2) {
					lk += "'bom_type':'" + $("#s_g_bom_type").val() + "',";
				}
				lk += "'p_bom_number':'" + $("#s_bom_number").val() + "'}";
				//明碼
				var lkp = "";
				lkp += $("#s_g_item").val() == "" ? "" : "<'項目類型':'" + $("#s_g_item").find('option:selected').text() + "'>";
				lkp += $("#s_i_item").val() == "" ? "" : "<'項目規格':'" + $("#s_i_item").find('option:selected').text() + "'>";
				lkp += $("#s_model").val() == "" ? "" : "<'產品型號':'" + $("#s_model").val() + "'>";
				lkp += $("#s_bom_number").val() == "" ? "" : "<'BOM編號':'" + $("#s_bom_number").val() + "'>";
				lkp += $("#s_order_id").val() == "" ? "" : "<'製令單':'" + $("#s_order_id").val() + "'>";

				$("#s_l_list").append('<div class="text-left m-0 d-none">' + lk + '</div><p class="mb-1 mt-1  small">' + lkp + '</p>');
				//清除選擇
				$("#s_model").val("");
				$("#s_bom_number").val("");
				$("#s_order_id").val("");
				$("#s_g_item").val("").trigger("change");
			},

			//選擇  預覽
			choose_show : function(a_u_type, event) {
				this.rm_added();
				var id = event.target.attributes.user_id.value;
				var fullDate = new Date();
				//convert month to 2 digits
				var twoDigitMonth = fullDate.getMonth() + 1 >= 10 ? fullDate.getMonth() + 1 : "0" + (fullDate.getMonth() + 1);
				var currentDate = fullDate.getFullYear() + "-" + twoDigitMonth + "-" + fullDate.getDate();

				this.s_0 = $(".t_row" + id + " .s_0")[0].innerText;
				$("#a_u_model").text($(".t_row" + id + " .s_1")[0].innerText);
				$("#a_u_version_bios").text($(".t_row" + id + " .s_2")[0].innerText);
				$("#a_u_bom_number").val($(".t_row" + id + " .s_3")[0].innerText);
				$("#c1_bom_number").text($(".t_row" + id + " .s_3")[0].innerText);
				$("#a_u_bom_id").text($(".t_row" + id + " .s_0")[0].innerText);
				$("#a_u_version_motherboard").text($(".t_row" + id + " .s_4")[0].innerText);

				$("#a_u_note").text($(".t_row" + id + " .s_5")[0].innerText);
				$("#a_u_kind").val($(".t_row" + id + " .s_7")[0].innerText).change();

				$("#a_u_mfg_part_no").text($(".t_row" + id + " .s_13")[0].innerText);
				$("#a_u_parts_no").text($(".t_row" + id + " .s_14")[0].innerText);

				if ($(".t_row" + id + " .s_7")[0].innerText == 1) {
					$("#kind1").text("量產單");
				} else {
					$("#kind1").text("技轉單");
				}

				var group_tbody = "";
				var $listLeft = $("#collapseAdded .listLeft");
				var $listRight = $("#collapseAdded .listRight");
				var $list_notUse = $("#collapseAdded .list_notUse");
				var $sample = $listLeft.find(".itemSample");
				var $sample_notUse = $list_notUse.find(".itemSample_notUse");
				$listLeft.add($listRight).find(".item").remove();
				var indexItemId = 5;
				var indexId = 6;
				var indexAmount = 8;//陣列[] 數量
				var indexOrder = 9;
				var indexName = 11;//陣列[] 項目名稱
				var indexContent = 12;//陣列[] 項目內容
				var $target = $listLeft;
				var counting = 0;
				var columnItemNumber = 21;//每行最多 項目
				this.group_list.sort(function(a, b) {
					return b[indexOrder] - a[indexOrder];
				});
				var notUse = 0;
				var needUse = 0;
				for (var i = 0; i < this.group_list.length; i++) {
					if (id == this.group_list[i][indexItemId] && this.group_list[i][indexId] != 1) {
						//如果數量大於0 ->上面顯示
						if (this.group_list[i][indexAmount] > 0) {
							needUse += 1;
							var $new = $sample.clone().show().removeClass("itemSample").addClass("item");
							//數量
							if (this.group_list[i][indexAmount] > 1) {
								$new.find(".amount").html("(x" + this.group_list[i][indexAmount] + ")");
							}
							//項目名稱
							$new.find(".name").html(this.group_list[i][indexName] + ":");
							//內容
							var tmp = [];
							for (var n = indexContent; n < this.group_list[i].length; n++) {
								tmp.push(this.group_list[i][n]);
							}
							$new.find(".content").html(tmp.join(" "));
							counting = counting + 1;
							if (counting > columnItemNumber)
								$target = $listRight;
							$target.append($new);
						} else {
							notUse += 1
							//如果數量小於0 ->下面顯示 d-none 
							var $new_notUse = $sample_notUse.clone().show().removeClass("d-none").removeClass("itemSample_notUse").addClass("item_notUse");
							//項目名稱
							$new_notUse.find(".name").html(this.group_list[i][indexName] + ":");
							//內容
							var tmp = [];
							for (var n = indexContent; n < this.group_list[i].length; n++) {
								tmp.push(this.group_list[i][n]);
							}
							$new_notUse.find(".content").html(tmp.join(" "));
							$list_notUse.append($new_notUse);
						}
					}
				}
				//計算
				$("#notUseNb").text(this.notUseNb - notUse);
				$("#needUseNb").text(this.needUseNb - needUse);
				$("#c1_bom_type").text($(".t_row" + id + " .s_12")[0].innerText);
				$("#c1_note").text(
						"表單編號:QR-701-06 / 規格負責人 : " + $(".t_row" + id + " .s_11")[0].innerText + " / 建單日期 : " + currentDate + " / 建單人 : "
								+ $("#nav_account").text() + " / 單據來源:" + this.current_report);
				$("#c1_note").attr('title', $(".t_row" + id + " .s_11")[0].innerText);
				$("#a_u_bom_principal").text($(".t_row" + id + " .s_11")[0].innerText);

				//可能是是 技轉單
				if ($("#a_u_kind").val() == "0") {
					$("#a_u_note2").val(this.a_u_note2_def);
				} else {
					$("#a_u_note2").val("");
				}
			},
			//頁數-初始化(新增 or 修改 or 刪除 or 條件 要重製)
			change_page_init : function() {
				//active 更換為第一格
				var a = "active";
				var d = "disabled";
				$(".page-item").removeClass(a);
				$(".page-item").removeClass(d);
				for (var re_page = 1; re_page <= 10; re_page++) {
					var now_page = re_page + (this.page_batch * 10);
					//如果就在第一頁 不需更換
					if (!$("#page-items .p" + now_page).hasClass("p" + re_page)) {
						$("#page-items .p" + now_page).addClass("p" + re_page);
						$("#page-items .p" + re_page).removeClass("p" + now_page);
						$("#page-items .p" + re_page + " a").text(re_page);
						$("#page-items .p" + re_page + " a").attr("id", "p" + re_page);
					}
					if (re_page == 1) {
						$("#page-items .p" + re_page).addClass(a);
					}
				}
				//分頁功能
				this.page_max = 100;//當前本批 筆數
				this.page_max_total = 100;//最大總數
				this.page_batch = 0;//第幾批
				this.page_batch_total = 100;//每批間格值
				this.page_every = 10;//當前每頁筆數
				this.page_stay = 1;//當前頁數

			},
			//頁數-刷新
			change_page_update : function() {
				//頁數-取得當前最大筆數 && 頁數
				this.page_max = this.search_list.length;
				$(".p_n").removeClass("disabled");
				if (this.page_max < this.page_max_total) {
					$(".p_n").addClass("disabled");
				}
				$(".p_p").removeClass("disabled");
				if (this.page_batch < 1) {
					$(".p_p").addClass("disabled");
				}
				//頁數-隱藏多於頁數
				$(".p_nb").addClass("disabled");

			},
			//頁數-換頁按鈕建置(頁數-每頁顯示)
			change_page_btn : function(i) {
				var d_none = "";
				if (i > (this.page_every * this.page_stay)) {
					d_none = "d-none";
				}
				//頁數-(個位數)+(十位數)
				var page_group = "pg_" + (Math.floor((i - 1) / this.page_every) + 1 + (this.page_batch * 10));
				var page_nb = "p" + (Math.floor((i - 1) / this.page_every) + 1 + (this.page_batch * 10));
				$("." + page_nb).removeClass("disabled");
				return page_group + " " + d_none;
			},
			//頁數-換頁查詢
			change_page : function(event) {
				var d = "disabled";
				var d_n = "d-none";
				var a = "active";
				var pg = "pg_";
				console.log("page btn is:" + event.text);
				//選定頁數
				if (event.id != "p_p" && event.id != "p_n") {
					$(".page-item").removeClass(a);
					$("." + event.id).addClass(a);

					$(".page_all").addClass(d_n);
					$("." + pg + event.text).removeClass(d_n);

				} else if (event.id == "p_p") {//上10頁(批數 要大於1)
					if (this.page_batch > 0) {
						//換上一批次 頁數
						$(".page-item").removeClass(a);

						for (var i = 1; i <= 10; i++) {
							var now_page = i + (this.page_batch * 10);
							var previous_page = i + ((this.page_batch) * 10) - 10;
							$(".p" + now_page).addClass("p" + previous_page);
							$(".p" + previous_page).removeClass("p" + now_page);
							$(".p" + previous_page + " a").text(previous_page);
							$(".p" + previous_page + " a").attr("id", "p" + previous_page);
							if (i == 1) {
								$(".p" + previous_page).addClass(a);
							}
						}
						this.page_batch -= 1;
						this.send_search("");
					}
				} else if (event.id == "p_n") {//下10頁(必須滿100筆最大量 )
					if (this.page_max >= this.page_max_total) {
						//換下一批次 頁數
						$(".page-item").removeClass(a);
						for (var i = 1; i <= 10; i++) {
							var now_page = i + (this.page_batch * 10);
							var next_page = i + ((this.page_batch + 1) * 10);
							$(".p" + now_page).addClass("p" + next_page);
							$(".p" + next_page).removeClass("p" + now_page);
							$(".p" + next_page + " a").text(next_page);
							$(".p" + next_page + " a").attr("id", "p" + next_page);
							if (i == 1) {
								$(".p" + next_page).addClass(a);
							}
						}
						this.page_batch += 1;
						this.send_search("");
					}
				}
				return false;
			},
			//傳送 查詢
			send_search : function(select) {
				var content = new Object();
				var search_list = [];

				//如果select = checked (登記生產) 檢查是否有勾選 
				if (select == "checked") {
					if (!$('#a_u_production input').prop('checked')) {
						this.current_report = "自訂";
						this.printDiv();
						return;
					} else {
						this.current_report = "生產注意事項";
						//登記 單據(檢核)
						var regex = new RegExp("^[A-Z0-9]+\-[A-Z0-9]+$");
						if (!regex.test($("#a_u_id").val())) {
							main.alertshow(true, "[製令單號]格式錯誤!!");
							return;
						}
						//檢核
						if ($('#needUseNb').text() < 0 || $('#notUseNb').text() < 0) {
							main.alertshow(true, "[可裝配 or 不裝配]項目數量異常 ,請再通知 [規格負責人: " + $("#c1_note").attr('title') + "] 請檢查[產品規格]後存檔!!");
							return false;
						}
						var itme_not_null = $('#setHardware .item .content');
						for (var i = 0; i < itme_not_null.length; i++) {
							if (itme_not_null[i].innerText.search('No') != -1 || itme_not_null[i].innerText.search('無') != -1) {
								main.alertshow(true, "[可裝配]內容 項目含[無 or No] ,請再通知 [規格負責人: " + $("#c1_note").attr('title') + "] 請檢查[產品規格]後存檔!!");
								return false;
							}
						}
						var itme_is_null = $('#setHardware_notUse .item_notUse .content');
						for (var i = 0; i < itme_is_null.length; i++) {
							if (itme_is_null[i].innerText.search('No') == -1 && itme_is_null[i].innerText.search('無') == -1) {
								main.alertshow(true, "[不裝配]內容 尚未含[無 or No] ,請再通知 [規格負責人: " + $("#c1_note").attr('title') + "] 請檢查[產品規格]後存檔!!");
								return false;
							}
						}
						if ($("#a_u_o_id").val().length > 80) {
							main.alertshow(true, "[訂單欄位]資料過長,請填入[備註欄位]內!!");
							return false;
						}
						content.production_id = $("#a_u_id").val();
						content.order_id = $("#a_u_o_id").val();
						content.product_hope_date = $("#a_u_o_date").val();
						content.order_country = $("#a_u_country").val();
						content.client_name = $("#a_u_c").val() + "(" + content.order_country + ")";
						content.bom_type = $("#c1_bom_type").text();
						//===包裝型態===
						var cb_pkg_all = {};
						for (var c = 1; c <= 9; c++) {
							var cb_pkg_name = $("#pkg_" + c + " .cb_pkg_name").text();
							var cb_pkg = $("#pkg_" + c + " .cb_pkg input").attr('checked');
							cb_pkg = (cb_pkg == null ? "" : cb_pkg);
							cb_pkg_all["cb_pkg_" + c] = {
								"cb_pkg" : cb_pkg,
								"cb_pkg_name" : cb_pkg_name
							};
						}
						content.cb_pkg_all = cb_pkg_all;
						//===產品規格===
						var bom_product_content = {};
						var have = [];
						var not = [];
						var s_name = "", s_content = "", s_amount = "";
						var bom_sfn = $('.listLeft .item');
						//左邊
						for (var bpc = 0; bpc < bom_sfn.length; bpc++) {
							s_name = $(bom_sfn[bpc]).find('.name').text().replace(":", "");
							s_content = $(bom_sfn[bpc]).find('.content').text();
							s_amount = $(bom_sfn[bpc]).find('.amount').text();
							have.push({
								'name' : s_name,
								'content' : s_content,
								'amount' : s_amount
							});
						}
						bom_sfn = $('.listRight .item');
						//右邊
						for (var bpc = 0; bpc < bom_sfn.length; bpc++) {
							s_name = $(bom_sfn[bpc]).find('.name').text().replace(":", "");
							s_content = $(bom_sfn[bpc]).find('.content').text();
							s_amount = $(bom_sfn[bpc]).find('.amount').text();
							have.push({
								'name' : s_name,
								'content' : s_content,
								'amount' : s_amount
							});
						}
						//不使用
						bom_sfn = $('.item_notUse');
						for (var bpc = 0; bpc < bom_sfn.length; bpc++) {
							s_name = $(bom_sfn[bpc]).find('.name').text().replace(":", "");
							s_content = $(bom_sfn[bpc]).find('.content').text();
							s_amount = $(bom_sfn[bpc]).find('.amount').text();
							not.push({
								'name' : s_name,
								'content' : s_content,
								'amount' : s_amount
							});
						}
						bom_product_content['not'] = not;
						bom_product_content['have'] = have;
						content.bom_product_content = bom_product_content;

						//===數量===
						var quantity = 0;
						if ($("#a_u_nb").val() != "" && $.isNumeric($("#a_u_nb").val())) {
							quantity = $("#a_u_nb").val();
						}

						content.production_quantity = quantity;
						content.product_model = $("#a_u_model").text();
						content.bom_product_id = $("#c1_bom_number").text();
						if ($("#c1_bom_number").text() == $("#a_u_bom_number").val()) {
							content.bom_product_customer_id = "";
						} else {
							content.bom_product_customer_id = $("#a_u_bom_number").val();
						}

						content.product_type = $("#kind1").text();
						content.bom_id = $("#a_u_bom_id").text();
						content.bom_principal = $("#a_u_bom_principal").text();
						content.mfg_part_no = $("#a_u_mfg_part_no").text();
						content.parts_no = $("#a_u_parts_no").text();
						content.version_motherboard = $("#a_u_version_bios").text();
						content.pm_note = $("#a_u_note").text();
						content.note = $("#a_u_note2").val();
						content.come_from = "生產注意事項";
						content.product_progress = 2;
						//如果有任何空值
						if (content.product_hope_date == "" || content.order_country == "" || content.production_id == "" || content.order_id == ""
								|| content.client_name == "" || quantity == "") {
							main.alertshow(true, " 尚未填寫完整,請再次檢查清楚!!");
							return;
						}
					}
				}

				for (var i = 1; i < $("#s_l_list div").length; i++) {
					search_list.push($("#s_l_list div")[i].innerText);
				}

				content.page_nb = this.page_batch * this.page_batch_total;//批次(起始數)
				content.page_total = this.page_batch_total;//(每次要的最大數量)
				content.search_list = search_list;
				//更新 單據類型(技轉/量產)
				content.product_id = templateBody.s_0;
				content.product_kind = $('#a_u_kind').val();

				content.user = $("#nav_account").text();
				var order = "search_update"; //指令
				var url = "./bom_print.do";
				switch (select) {
				case "checked":
					order = "search_update_print";
					url = "./production_records_add.do";
					break;
				case "kind":
					url = "./bom_product_kind.do";
					break;
				}

				var data = JSON.stringify({
					data : {
						datetime : "",
						action : "R",
						whoami : main.loginData.account,
						cellBackName : "bodyAfter",
						cellBackOrder : order,
						content : content,
					},
				});
				main.ajaxSend(url, data);
			},
			printDiv : function() {
				var divToPrint = document.getElementById("collapseAddedPrint");
				var style = document.getElementById("table2Style");
				var newWin = window.open("", "Print-Window");
				newWin.document.open();
				newWin.document.write("<html>" + "<head>" + '<link rel="stylesheet" href="./thirdparty/css/bootstrap-4.4.1.min.css" />' + style.outerHTML
						+ "</head>" + '<body onload="window.print()" class="container" id="main">' + "<div>" + divToPrint.innerHTML + "</div>" + "</body>"
						+ "</html>");

				newWin.document.getElementById('a_u_id').value = $("#a_u_id").val();
				newWin.document.getElementById('a_u_o_id').value = $("#a_u_o_id").val();
				newWin.document.getElementById('a_u_o_date').value = $("#a_u_o_date").val();
				newWin.document.getElementById('a_u_country').value = $("#a_u_country").val();
				newWin.document.getElementById('a_u_bom_number').value = $("#a_u_bom_number").val();
				newWin.document.getElementById('a_u_note').text = $("#a_u_note").text();
				newWin.document.getElementById('a_u_note2').value = $('#a_u_note2').val();
				newWin.document.getElementById('a_u_c').value = $("#a_u_c").val();
				newWin.document.getElementById('a_u_nb').value = $("#a_u_nb").val();

				newWin.document.close();

				setTimeout(function() {
					newWin.close();
				}, 500);
			},

			//Rsp-回傳值-指令
			bodyAfter : function(event) {
				console.log("to index success");
				switch (event.r_cellBackOrder) {
				case "search_update":
					//刷新資料
					if (event.r_content.templateInfo.body["list"] != null && event.r_content.templateInfo.body["list"] != "") {
						this.group_list = main.contentData.templateInfo.body["group_list"];
						this.item_list = main.contentData.templateInfo.body["item_list"];
						this.search_list = main.contentData.templateInfo.body["list"];
						//自動化 填入
						if (main.contentData.templateInfo.body["tempAutoBomPrint"].orderId != null) {
							var tempAutoBomPrint = main.contentData.templateInfo.body["tempAutoBomPrint"];
							main.tempAutoBomPrint.packagePC = tempAutoBomPrint.packagePC;
							main.tempAutoBomPrint.packageBOG = tempAutoBomPrint.packageBOG;
							main.tempAutoBomPrint.packageL = tempAutoBomPrint.packageL;
							main.tempAutoBomPrint.packageBL = tempAutoBomPrint.packageBL;
							main.tempAutoBomPrint.packageBP = tempAutoBomPrint.packageBP;
							main.tempAutoBomPrint.packageRP = tempAutoBomPrint.packageRP;
							main.tempAutoBomPrint.packageOS = tempAutoBomPrint.packageOS;
							//main.tempAutoBomPrint.noteMoc = tempAutoBomPrint.noteMoc;
							main.tempAutoBomPrint.autoStep2 = true;
							console.log(main.tempAutoBomPrint);
						}
						//沒有資料
						if (event.r_content.templateInfo.body["list"].length < 2) {
							main.alertshow(true, "結果->無資料!!");
						}
						this.search_update();
					}

					break;
				case "search_update_print":

					if (event.r_content.templateInfo.body["list"] != null && event.r_content.templateInfo.body["list"] != "") {
						this.group_list = main.contentData.templateInfo.body["group_list"];
						this.item_list = main.contentData.templateInfo.body["item_list"];
						this.search_list = main.contentData.templateInfo.body["list"];
						this.search_update();

						//如果是登記生產
						this.printDiv();
					}
					break;
				}
			},
		},
		//移除監聽事件
		beforeDestroy : function() {
			console.log("to beforeDestroy event");
			$(document).off("click", "#a_u_group_name select");
			$(document).off("click", "#search_choose input");
			$(document).off("click", "#s_submit");
			$(document).off("click", "#a_c_submit");
			$(document).off("click", "#p_submit");
			$(document).off("click", "#m_s_submit");

			$(document).off("click", ".a_submit");
			$(document).off("click", "#s_l_submit");
			$(document).off("click", "#s_c_submit");
			$(document).off("change", "#s_g_bom_type");
			$(document).off("change", "#s_g_item");

			$(document).off("click", "#a_item");
			$(document).off("click", ".a_i_item");
			$(document).off("click", ".from_move");
			$(document).off("click", ".cb_pkg");

		},
	});
</script>
